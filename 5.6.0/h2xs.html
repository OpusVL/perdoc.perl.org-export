      
      
      
      

      <!DOCTYPE html>
      <html lang="en">

      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="h2xs - perldoc.perl.org">
        <link rel="icon" href="/public/img/favicon.ico">
        <title>h2xs - perldoc.perl.org</title>
        <link href="/public/css/main.min.css" rel="stylesheet">
        <link rel="canonical" href="/h2xs.html">
        <link
          href='https://fonts.googleapis.com/css?family=Lato:400,100,300,700,900'
          rel='stylesheet' type='text/css'>
        <script>
          window.ga = window.ga || function () {
            (ga.q = ga.q || []).push(arguments)
          };
          ga.l = +new Date;
          ga('create', 'UA-1892152-2', 'auto'); // JJ's account
          ga('create', 'UA-50555-3', 'auto', 'perlOrg'); // perl.org account
          ga('require', 'outboundLinkTracker', {
            events: ['click', 'auxclick', 'contextmenu'],
          });
          ga('require', 'maxScrollTracker');
          ga('send', 'pageview');
          ga('perlOrg.send', 'pageview');
        </script>
        <script async src="https://www.google-analytics.com/analytics.js">
        </script>
        <script async src="/public/js/tracking.min.js"></script>
      </head>

      <body class="body container-fluid ">
        <div class="wrapper">

          <nav
    class="navbar navbar-dark bg-primary bg-perl fixed-top justify-content-between navbar-expand-lg">
    <a href="#content" class="skippy sr-only sr-only-focusable">
        <span class=' skippy-text'>Skip to main content</span>
    </a>
    <a class="navbar-brand" href="/">
        <img class="logo" src="/public/img/logo_perl_doc.svg"
            alt="Perl Documentation Logo" />
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse"
        data-target="#navbar" aria-controls="navbar" aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div id="navbar" class="collapse navbar-collapse ">
        <ul class="navbar-nav ml-auto navbar-right">
            <form class="nav-item dropdown search-wrapper">
                <input type="text" id='searchinput' aria-describedby='navbarDropdown5'
                    placeholder="Type query" class='search-input-field' value=''>

                <button href="#" data-toggle='dropdown' type="button"
                    aria-haspopup="true" aria-expanded='false' id="navbarDropdown5"
                    class="nav-link dropdown-toggle search-link">
                    <object tabindex='-1' focusable="false" class='search-icon'
                        data="/public/img/search.svg" type="image/svg+xml"
                        name='search icon'>search
                        icon</object>
                </button>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown5"
                    id='search-results'>
                    <p class='dropdown-item major-version'>
                        No results
                    </p>
                </div>
            </form>
            <li class="nav-item dropdown">
                <a id="navbarDropdown" href="#" class="nav-link dropdown-toggle"
                    data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false">Perl versions</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    
                        <p class='dropdown-item major-version'>
                            5.32
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.32.0/">5.32.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.30
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.30.3/">5.30.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.30.2/">5.30.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.30.1/">5.30.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.30.0/">5.30.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.28
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.28.3/">5.28.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.28.2/">5.28.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.28.1/">5.28.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.28.0/">5.28.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.26
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.26.3/">5.26.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.26.2/">5.26.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.26.1/">5.26.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.26.0/">5.26.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.24
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.24.4/">5.24.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.24.3/">5.24.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.24.2/">5.24.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.24.1/">5.24.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.24.0/">5.24.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.22
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.22.4/">5.22.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.22.3/">5.22.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.22.2/">5.22.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.22.1/">5.22.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.22.0/">5.22.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.20
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.20.3/">5.20.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.20.2/">5.20.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.20.1/">5.20.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.20.0/">5.20.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.18
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.18.4/">5.18.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.18.3/">5.18.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.18.2/">5.18.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.18.1/">5.18.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.18.0/">5.18.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.16
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.16.3/">5.16.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.16.2/">5.16.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.16.1/">5.16.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.16.0/">5.16.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.14
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.14.4/">5.14.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.14.3/">5.14.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.14.2/">5.14.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.14.1/">5.14.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.14.0/">5.14.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.12
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.12.5/">5.12.5</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.4/">5.12.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.3/">5.12.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.2/">5.12.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.1/">5.12.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.0/">5.12.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.10
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.10.1/">5.10.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.10.0/">5.10.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.8
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.8.9/">5.8.9</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.8/">5.8.8</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.7/">5.8.7</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.6/">5.8.6</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.5/">5.8.5</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.4/">5.8.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.3/">5.8.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.2/">5.8.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.1/">5.8.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.0/">5.8.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.6
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.6.2/">5.6.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.6.1/">5.6.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.6.0/">5.6.0</a>
                        
                        
                    
                </div>
            </li>
            <li class="nav-item dropdown">
                <a id="navbarDropdown1" href="#" class="dropdown-toggle nav-link"
                    data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false">Manuals</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown1">
                    <a class="dropdown-item"
                        href="/5.6.0/index-overview.html">Overview</a>
                    <a class="dropdown-item"
                        href="/5.6.0/index-tutorials.html">Tutorials</a>
                    <a class="dropdown-item"
                        href="/5.6.0/index-faq.html">FAQs</a>
                    <a class="dropdown-item"
                        href="/5.6.0/index-history.html">Changes</a>
                    <a class="dropdown-item"
                        href="/5.6.0/index-licence.html">License</a>
                    <a class="dropdown-item"
                        href="/5.6.0/index-language.html">Language</a>
                    <a class="dropdown-item"
                        href="/5.6.0/index-functions.html">Functions</a>
                    <a class="dropdown-item"
                        href="/5.6.0/perlop.html">Operators</a>
                    <a class="dropdown-item"
                        href="/5.6.0/perlvar.html">Variables</a>
                    <a class="dropdown-item"
                        href="/5.6.0/index-pragmas.html">Pragmas</a>
                    <a class="dropdown-item"
                        href="/5.6.0/index-utilities.html">Utilities</a>
                    <a class="dropdown-item"
                        href="/5.6.0/index-internals.html">Internals</a>
                    <a class="dropdown-item"
                        href="/5.6.0/index-platforms.html">Platforms</a>
                </div>
            </li>
            <li class="nav-item dropdown">
                <a id="navbarDropdown3" href="#" class="nav-link dropdown-toggle "
                    data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false">Modules</a>
                <div aria-labelledby="navbarDropdown3"
                    class="dropdown-menu letters-wrap">
                    <!--<a class="dropdown-item"
                        href="/5.6.0/index-modules.html">A-Z</a>
                    <a class="dropdown-item"
                        href="/5.6.0/index-modules-by-cat.html">By
                        Category</a>-->
                    <div class="dropdown-divider"></div>
                    <div class="letter-container">
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-A.html">A</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-B.html">B</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-C.html">C</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-D.html">D</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-E.html">E</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-F.html">F</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-G.html">G</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-H.html">H</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-I.html">I</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-J.html">J</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-K.html">K</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-L.html">L</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-M.html">M</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-N.html">N</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-O.html">O</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-P.html">P</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-Q.html">Q</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-R.html">R</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-S.html">S</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-T.html">T</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-U.html">U</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-V.html">V</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-W.html">W</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-X.html">X</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-Y.html">Y</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-modules-Z.html">Z</a>
                    </div>
                </div>
            </li>
            <li class="nav-item dropdown">
                <a id="navbarDropdown4" href="#" class="nav-link dropdown-toggle "
                    data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false">Functions</a>
                <div aria-labelledby="navbarDropdown4"
                    class="dropdown-menu letters-wrap">
                    <a class="dropdown-item"
                        href="/5.6.0/index-functions.html">A-Z</a>
                    <a class="dropdown-item"
                        href="/5.6.0/index-functions-by-cat.html">By
                        Category</a>
                    <div class="dropdown-divider"></div>
                    <div class="letter-container">
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#A">A</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#B">B</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#C">C</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#D">D</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#E">E</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#F">F</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#G">G</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#H">H</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#I">I</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#J">J</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#K">K</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#L">L</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#M">M</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#N">N</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#O">O</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#P">P</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#Q">Q</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#R">R</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#S">S</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#T">T</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#U">U</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#V">V</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#W">W</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#X">X</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#Y">Y</a>
                        <a class="dropdown-item letters"
                            href="/5.6.0/index-functions.html#Z">Z</a>
                    </div>
                </div>
            </li>
        </ul>
    </div>
    <!--/.nav-collapse -->
</nav>


          <main class="row main-content pb-5 pt-5" id='content'>
            <div class="col-sm-10 offset-sm-1 col-xl-8 offset-xl-2">
              <div class="row">
                <div class="col-sm-12">
                  <div id="breadcrumbs">
                      
    <a href="index.html">Home</a>&nbsp; &gt;
    
      
        <a href="index-utilities.html">Utilities</a> &gt;
      
    
    h2xs
  

                  </div>
                </div>
              </div>
              <div class="row">
                <article class="col-sm-12 content">
                  <div class="documentation-wrapper">
                    <div id="perl_version">
                      <h7 class='page-title'> Perl 5 version 6.0
                        documentation</h7>
                    </div>
                    <h1>h2xs</h1>


  <!--    -->
<ul><li><a href="#NAME">NAME</a></li><li><a href="#SYNOPSIS">SYNOPSIS</a></li><li><a href="#DESCRIPTION">DESCRIPTION</a></li><li><a href="#OPTIONS">OPTIONS</a></li><li><a href="#EXAMPLES">EXAMPLES</a></li><li><a href="#ENVIRONMENT">ENVIRONMENT</a></li><li><a href="#AUTHOR">AUTHOR</a></li><li><a href="#SEE-ALSO">SEE ALSO</a></li><li><a href="#DIAGNOSTICS">DIAGNOSTICS</a></li><li><a href="#LIMITATIONS-of-*-x*">LIMITATIONS of *-x*</a></li><li><a href="#HISTORY">HISTORY</a></li><ul><li><a href="#EXPORT">EXPORT</a></li></ul></ul><a class='view-head1' id="NAME"></a><h2 class='h2' >NAME</h2>
<p>h2xs - convert .h C header files to Perl extensions</p>
<a class='view-head1' id="SYNOPSIS"></a><h2 class='h2' >SYNOPSIS</h2>
<p><strong>h2xs</strong> [<strong>-ACOPXcdf</strong>] [<strong>-v</strong> version] [<strong>-n</strong> module_name] [<strong>-p</strong> prefix] [<strong>-s</strong> sub] [headerfile ... [extra_libraries]]</p>
<p><strong>h2xs</strong> <strong>-h</strong></p>
<a class='view-head1' id="DESCRIPTION"></a><h2 class='h2' >DESCRIPTION</h2>
<p><i>h2xs</i> builds a Perl extension from C header files.  The extension
will include functions which can be used to retrieve the value of any
#define statement which was in the C header files.</p>
<p>The <i>module_name</i> will be used for the name of the extension.  If
module_name is not supplied then the name of the first header file
will be used, with the first character capitalized.</p>
<p>If the extension might need extra libraries, they should be included
here.  The extension Makefile.PL will take care of checking whether
the libraries actually exist and how they should be loaded.
The extra libraries should be specified in the form -lm -lposix, etc,
just as on the cc command line.  By default, the Makefile.PL will
search through the library path determined by Configure.  That path
can be augmented by including arguments of the form <strong>-L/another/library/path</strong>
in the extra-libraries argument.</p>
<a class='view-head1' id="OPTIONS"></a><h2 class='h2' >OPTIONS</h2>
<ul>
<li><a class='view-title' id="*-A*"></a><strong><strong>-A</strong></strong>
<p>Omit all autoload facilities.  This is the same as <strong>-c</strong> but also removes the
<code class="inline"><a class="l_k" href="functions/use.html">use</a> <span class="w">AutoLoader</span></code>
 statement from the .pm file.</p>
</li>
<li><a class='view-title' id="*-C*"></a><strong><strong>-C</strong></strong>
<p>Omits creation of the <i>Changes</i> file, and adds a HISTORY section to
the POD template.</p>
</li>
<li><a class='view-title' id="*-F*"></a><strong><strong>-F</strong></strong>
<p>Additional flags to specify to C preprocessor when scanning header for
function declarations.  Should not be used without <strong>-x</strong>.</p>
</li>
<li><a class='view-title' id="*-M*-_regular-expression_"></a><strong><strong>-M</strong> <i>regular expression</i></strong>
<p>selects functions/macros to process.</p>
</li>
<li><a class='view-title' id="*-O*"></a><strong><strong>-O</strong></strong>
<p>Allows a pre-existing extension directory to be overwritten.</p>
</li>
<li><a class='view-title' id="*-P*"></a><strong><strong>-P</strong></strong>
<p>Omit the autogenerated stub POD section.</p>
</li>
<li><a class='view-title' id="*-X*"></a><strong><strong>-X</strong></strong>
<p>Omit the XS portion.  Used to generate templates for a module which is not
XS-based.  <code class="inline">-c</code>
 and <code class="inline">-f</code>
 are implicitly enabled.</p>
</li>
<li><a class='view-title' id="*-a*"></a><strong><strong>-a</strong></strong>
<p>Generate an accessor method for each element of structs and unions. The
generated methods are named after the element name; will return the current
value of the element if called without additional arguments; and will set
the element to the supplied value (and return the new value) if called with
an additional argument. Embedded structures and unions are returned as a
pointer rather than the complete structure, to facilitate chained calls.</p>
<p>These methods all apply to the Ptr type for the structure; additionally
two methods are constructed for the structure type itself, <code class="inline"><span class="w">_to_ptr</span></code>

which returns a Ptr type pointing to the same structure, and a <code class="inline"><span class="w">new</span></code>

method to construct and return a new structure, initialised to zeroes.</p>
</li>
<li><a class='view-title' id="*-c*"></a><strong><strong>-c</strong></strong>
<p>Omit <code class="inline"><span class="i">constant</span><span class="s">(</span><span class="s">)</span></code>
 from the .xs file and corresponding specialised
<code class="inline">AUTOLOAD</code>
 from the .pm file.</p>
</li>
<li><a class='view-title' id="*-d*"></a><strong><strong>-d</strong></strong>
<p>Turn on debugging messages.</p>
</li>
<li><a class='view-title' id="*-f*"></a><strong><strong>-f</strong></strong>
<p>Allows an extension to be created for a header even if that header is
not found in standard include directories.</p>
</li>
<li><a class='view-title' id="*-h*"></a><strong><strong>-h</strong></strong>
<p>Print the usage, help and version for this h2xs and exit.</p>
</li>
<li><a class='view-title' id="*-k*"></a><strong><strong>-k</strong></strong>
<p>For function arguments declared as <code class="inline"><span class="w">const</span></code>
, omit the const attribute in the
generated XS code.</p>
</li>
<li><a class='view-title' id="*-m*"></a><strong><strong>-m</strong></strong>
<p><strong>Experimental</strong>: for each variable declared in the header file(s), declare
a perl variable of the same name magically tied to the C variable.</p>
</li>
<li><a class='view-title' id="*-n*-_module_name_"></a><strong><strong>-n</strong> <i>module_name</i></strong>
<p>Specifies a name to be used for the extension, e.g., -n RPC::DCE</p>
</li>
<li><a class='view-title' id="*-o*-_regular-expression_"></a><strong><strong>-o</strong> <i>regular expression</i></strong>
<p>Use "opaque" data type for the C types matched by the regular
expression, even if these types are <code class="inline"><span class="w">typedef</span></code>
-equivalent to types
from typemaps.  Should not be used without <strong>-x</strong>.</p>
<p>This may be useful since, say, types which are <code class="inline"><span class="w">typedef</span></code>
-equivalent
to integers may represent OS-related handles, and one may want to work
with these handles in OO-way, as in <code class="inline"><span class="i">$handle</span><span class="i">-&gt;do_something</span><span class="s">(</span><span class="s">)</span></code>
.
Use <code class="inline">-o .</code>
 if you want to handle all the <code class="inline"><span class="w">typedef</span></code>
ed types as opaque types.</p>
<p>The type-to-match is whitewashed (except for commas, which have no
whitespace before them, and multiple <code class="inline"><span class="i">*</span></code>
 which have no whitespace
between them).</p>
</li>
<li><a class='view-title' id="*-p*-_prefix_"></a><strong><strong>-p</strong> <i>prefix</i></strong>
<p>Specify a prefix which should be removed from the Perl function names, e.g., -p sec_rgy_ 
This sets up the XS <strong>PREFIX</strong> keyword and removes the prefix from functions that are
autoloaded via the <code class="inline"><span class="i">constant</span><span class="s">(</span><span class="s">)</span></code>
 mechanism.</p>
</li>
<li><a class='view-title' id="*-s*-_sub1%2csub2_"></a><strong><strong>-s</strong> <i>sub1,sub2</i></strong>
<p>Create a perl subroutine for the specified macros rather than autoload with the constant() subroutine.
These macros are assumed to have a return type of <strong>char *</strong>, e.g., -s sec_rgy_wildcard_name,sec_rgy_wildcard_sid.</p>
</li>
<li><a class='view-title' id="*-v*-_version_"></a><strong><strong>-v</strong> <i>version</i></strong>
<p>Specify a version number for this extension.  This version number is added
to the templates.  The default is 0.01.</p>
</li>
<li><a class='view-title' id="*-x*"></a><strong><strong>-x</strong></strong>
<p>Automatically generate XSUBs basing on function declarations in the
header file.  The package <code class="inline"><span class="w">C::Scan</span></code>
 should be installed. If this
option is specified, the name of the header file may look like
<code class="inline"><span class="w">NAME1</span><span class="cm">,</span><span class="w">NAME2</span></code>
. In this case NAME1 is used instead of the specified string,
but XSUBs are emitted only for the declarations included from file NAME2.</p>
<p>Note that some types of arguments/return-values for functions may
result in XSUB-declarations/typemap-entries which need
hand-editing. Such may be objects which cannot be converted from/to a
pointer (like <code class="inline"><span class="w">long</span> <span class="w">long</span></code>
), pointers to functions, or arrays.  See
also the section on <a href="#LIMITATIONS-of--x">LIMITATIONS of -x</a>.</p>
</li>
</ul>
<a class='view-head1' id="EXAMPLES"></a><h2 class='h2' >EXAMPLES</h2>
<pre class="verbatim"><ol><li>	<span class="c"># Default behavior, extension is Rusers</span></li><li>	<span class="w">h2xs</span> <span class="w">rpcsvc</span>/<span class="w">rusers</span></li><li></li><li>	<span class="c"># Same, but extension is RUSERS</span></li><li>	<span class="w">h2xs</span> -<span class="w">n</span> <span class="w">RUSERS</span> <span class="w">rpcsvc</span>/<span class="w">rusers</span></li><li></li><li>	<span class="c"># Extension is rpcsvc::rusers. Still finds &lt;rpcsvc/rusers.h&gt;</span></li><li>	<span class="w">h2xs</span> <span class="w">rpcsvc::rusers</span></li><li></li><li>	<span class="c"># Extension is ONC::RPC.  Still finds &lt;rpcsvc/rusers.h&gt;</span></li><li>	<span class="w">h2xs</span> -<span class="w">n</span> <span class="w">ONC::RPC</span> <span class="w">rpcsvc</span>/<span class="w">rusers</span></li><li></li><li>	<span class="c"># Without constant() or AUTOLOAD</span></li><li>	<span class="w">h2xs</span> -c <span class="w">rpcsvc</span>/<span class="w">rusers</span></li><li></li><li>	<span class="c"># Creates templates for an extension named RPC</span></li><li>	<span class="w">h2xs</span> -<span class="w">cfn</span> <span class="w">RPC</span></li><li></li><li>	<span class="c"># Extension is ONC::RPC.</span></li><li>	<span class="w">h2xs</span> -<span class="w">cfn</span> <span class="w">ONC::RPC</span></li><li></li><li>	<span class="c"># Makefile.PL will look for library -lrpc in </span></li><li>	<span class="c"># additional directory /opt/net/lib</span></li><li>	<span class="w">h2xs</span> <span class="w">rpcsvc</span>/<span class="w">rusers</span> -<span class="w">L</span>/<span class="w">opt</span>/<span class="w">net</span>/<span class="w">lib</span> -<span class="w">lrpc</span></li><li></li><li>        <span class="c"># Extension is DCE::rgynbase</span></li><li>        <span class="c"># prefix &quot;sec_rgy_&quot; is dropped from perl function names</span></li><li>        <span class="w">h2xs</span> -<span class="w">n</span> <span class="w">DCE::rgynbase</span> -p <span class="w">sec_rgy_</span> <span class="w">dce</span>/<span class="w">rgynbase</span></li><li></li><li>        <span class="c"># Extension is DCE::rgynbase</span></li><li>        <span class="c"># prefix &quot;sec_rgy_&quot; is dropped from perl function names</span></li><li>        <span class="c"># subroutines are created for sec_rgy_wildcard_name and sec_rgy_wildcard_sid</span></li><li>        <span class="w">h2xs</span> -<span class="w">n</span> <span class="w">DCE::rgynbase</span> -p <span class="w">sec_rgy_</span> \</li><li>        -s <span class="w">sec_rgy_wildcard_name</span><span class="cm">,</span><span class="w">sec_rgy_wildcard_sid</span> <span class="w">dce</span>/<span class="w">rgynbase</span></li><li></li><li>	<span class="c"># Make XS without defines in perl.h, but with function declarations</span></li><li>	<span class="c"># visible from perl.h. Name of the extension is perl1.</span></li><li>	<span class="c"># When scanning perl.h, define -DEXT=extern -DdEXT= -DINIT(x)=</span></li><li>	<span class="c"># Extra backslashes below because the string is passed to shell.</span></li><li>	<span class="c"># Note that a directory with perl header files would </span></li><li>	<span class="c">#  be added automatically to include path.</span></li><li>	<span class="w">h2xs</span> -<span class="w">xAn</span> <span class="w">perl1</span> -<span class="w">F</span> <span class="q">&quot;-DEXT=extern -DdEXT= -DINIT\(x\)=&quot;</span> <span class="w">perl</span>.<span class="w">h</span></li><li></li><li>	<span class="c"># Same with function declaration in proto.h as visible from perl.h.</span></li><li>	<span class="w">h2xs</span> -<span class="w">xAn</span> <span class="w">perl2</span> <span class="w">perl</span>.<span class="w">h</span><span class="cm">,</span><span class="w">proto</span>.<span class="w">h</span></li><li></li><li>	<span class="c"># Same but select only functions which match /^av_/</span></li><li>	<span class="w">h2xs</span> -M <span class="q">&#39;^av_&#39;</span> -<span class="w">xAn</span> <span class="w">perl2</span> <span class="w">perl</span>.<span class="w">h</span><span class="cm">,</span><span class="w">proto</span>.<span class="w">h</span></li><li></li><li>	<span class="c"># Same but treat SV* etc as &quot;opaque&quot; types</span></li><li>	<span class="w">h2xs</span> -o <span class="q">&#39;^[S]V \*$&#39;</span> -<span class="w">M</span> <span class="q">&#39;^av_&#39;</span> -<span class="w">xAn</span> <span class="w">perl2</span> <span class="w">perl</span>.<span class="w">h</span><span class="cm">,</span><span class="w">proto</span>.<span class="w">h</span></li></ol></pre><a class='view-head1' id="ENVIRONMENT"></a><h2 class='h2' >ENVIRONMENT</h2>
<p>No environment variables are used.</p>
<a class='view-head1' id="AUTHOR"></a><h2 class='h2' >AUTHOR</h2>
<p>Larry Wall and others</p>
<a class='view-head1' id="SEE-ALSO"></a><h2 class='h2' >SEE ALSO</h2>
<p><a href="perl.html">perl</a>, <a href="perlxstut.html">perlxstut</a>, <a href="https://search.cpan.org/perldoc/ExtUtils::MakeMaker">ExtUtils::MakeMaker</a>, and <a href="https://search.cpan.org/perldoc/AutoLoader">AutoLoader</a>.</p>
<a class='view-head1' id="DIAGNOSTICS"></a><h2 class='h2' >DIAGNOSTICS</h2>
<p>The usual warnings if it cannot read or write the files involved.</p>
<a class='view-head1' id="LIMITATIONS-of-*-x*"></a><h2 class='h2' >LIMITATIONS of <strong>-x</strong></h2>
<p><i>h2xs</i> would not distinguish whether an argument to a C function
which is of the form, say, <code class="inline"><a class="l_k" href="functions/int.html">int</a> <span class="i">*</span></code>
, is an input, output, or
input/output parameter.  In particular, argument declarations of the
form</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/int.html">int</a></li><li>    <span class="i">foo</span><span class="s">(</span><span class="w">n</span><span class="s">)</span></li><li>	<a class="l_k" href="functions/int.html">int</a> <span class="i">*n</span></li></ol></pre><p>should be better rewritten as</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/int.html">int</a></li><li>    <span class="i">foo</span><span class="s">(</span><span class="w">n</span><span class="s">)</span></li><li>	<a class="l_k" href="functions/int.html">int</a> <span class="i">&amp;n</span></li></ol></pre><p>if <code class="inline"><span class="w">n</span></code>
 is an input parameter.</p>
<p>Additionally, <i>h2xs</i> has no facilities to intuit that a function</p>
<pre class="verbatim"><ol><li>   <a class="l_k" href="functions/int.html">int</a></li><li>   <span class="i">foo</span><span class="s">(</span><span class="w">addr</span><span class="cm">,</span><span class="w">l</span><span class="s">)</span></li><li>	<span class="w">char</span> *<span class="w">addr</span></li><li>	<a class="l_k" href="functions/int.html">int</a>   <span class="w">l</span></li></ol></pre><p>takes a pair of address and length of data at this address, so it is better
to rewrite this function as</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/int.html">int</a></li><li>    <span class="i">foo</span><span class="s">(</span><span class="w">sv</span><span class="s">)</span></li><li>	    <span class="w">SV</span> *<span class="w">addr</span></li><li>	<span class="w">PREINIT</span><span class="co">:</span></li><li>	    <span class="w">STRLEN</span> <span class="w">len</span><span class="sc">;</span></li><li>	    <span class="w">char</span> *<span class="q">s;</span></li><li>	<span class="q">	CODE:</span></li><li>	    <span class="q">	    s = SvPV(sv,len);</span></li><li>	    <span class="q">	    RETVAL = foo(s, len);</span></li><li>	<span class="w">OUTPUT</span><span class="co">:</span></li><li>	    <span class="w">RETVAL</span></li></ol></pre><p>or alternately</p>
<pre class="verbatim"><ol><li>    <span class="w">static</span> <a class="l_k" href="functions/int.html">int</a></li><li>    <span class="i">my_foo</span><span class="s">(</span><span class="w">SV</span> *<span class="w">sv</span><span class="s">)</span></li><li>    <span class="s">{</span></li><li>	<span class="w">STRLEN</span> <span class="w">len</span><span class="sc">;</span></li><li>	<span class="w">char</span> *<span class="q">s = SvPV(sv,len);</span></li><li></li><li>	<span class="q">	return foo(s, len);</span></li><li>    <span class="q">    }</span></li><li></li><li>    <span class="q">    MODULE = foo	PACKAGE =</span> <span class="w">foo</span>	<span class="w">PREFIX</span> = <span class="w">my_</span></li><li></li><li>    <a class="l_k" href="functions/int.html">int</a></li><li>    <span class="i">foo</span><span class="s">(</span><span class="w">sv</span><span class="s">)</span></li><li>	<span class="w">SV</span> *<span class="w">sv</span></li></ol></pre><p>See <a href="perlxs.html">perlxs</a> and <a href="perlxstut.html">perlxstut</a> for additional details.</p>
<a class='view-head1' id="HISTORY"></a><h2 class='h2' >HISTORY</h2>
<ul>
<li><a class='view-title' id="%24TEMPLATE_VERSION"></a><strong>$TEMPLATE_VERSION</strong>
<p>Original version; created by h2xs $H2XS_VERSION with options</p>
<pre class="verbatim"><ol><li>  <span class="i">@ARGS</span></li></ol></pre></li>
</ul>
<p>EOT</p>
<p>my $exp_doc = &lt;&lt;EOD;</p>
<a class='view-head2' id="EXPORT"></a><h3 class='h3' >EXPORT</h3>
<p>None by default.</p>
<p>EOD
if (@const_names and not $opt_P) {
  $exp_doc .= &lt;&lt;EOD;
=head2 Exportable constants</p>
<pre class="verbatim"><ol><li>  <span class="i">@</span>{<span class="s">[</span><a class="l_k" href="functions/join.html">join</a> <span class="q">&quot;\n  &quot;</span><span class="cm">,</span> <span class="i">@const_names</span><span class="s">]</span>}</li></ol></pre><p>EOD
}
if (defined $fdecls and @$fdecls and not $opt_P) {
  $exp_doc .= &lt;&lt;EOD;
=head2 Exportable functions</p>
<p>EOD
  $exp_doc .= &lt;&lt;EOD if $opt_p;
When accessing these functions from Perl, prefix <code class="inline"><span class="i">$opt_p</span></code>
 should be removed.</p>
<p>EOD
  $exp_doc .= &lt;&lt;EOD;
  @{[join "\n  ", @known_fnames{@fnames}]}</p>
<p>EOD
}</p>
<p>my $pod = &lt;&lt;"END" unless $opt_P;
## Below is stub documentation for your module. You better edit it!
#
#=head1 NAME
#
#$module - Perl extension for blah blah blah
#
#=head1 SYNOPSIS
#
#  use $module;
#  blah blah blah
#
#=head1 DESCRIPTION
#
#Stub documentation for $module, created by h2xs. It looks like the
#author of the extension was negligent enough to leave the stub
#unedited.
#
#Blah blah blah.
#$exp_doc$revhist
#=head1 AUTHOR
#
#$author, $email
#
#=head1 SEE ALSO
#
#perl(1).
#
#=cut
END</p>
<p>$pod =~ s/^\#//gm unless $opt_P;
print PM $pod unless $opt_P;</p>
<p>close PM;</p>
<p>if( ! $opt_X ){ # print XS, unless it is disabled
warn "Writing $ext$modpname/$modfname.xs\n";</p>
<p>print XS &lt;&lt;"END";
#include "EXTERN.h"
#include "perl.h"
#include "XSUB.h"</p>
<p>END
if( @path_h ){
    foreach my $path_h (@path_h_ini) {
	my($h) = $path_h;
	$h =~ s#^/usr/include/##;
	if ($^O eq 'VMS') { $h =~ s#.*vms\]#sys/# or $h =~ s#.*[:&gt;\]]##; }
        print XS qq{#include &lt;$h&gt;\n};
    }
    print XS "\n";
}</p>
<p>my %pointer_typedefs;
my %struct_typedefs;</p>
<p>sub td_is_pointer {
  my $type = shift;
  my $out = $pointer_typedefs{$type};
  return $out if defined $out;
  my $otype = $type;
  $out = ($type =~ /\*$/);
  # This converts only the guys which do not have trailing part in the typedef
  if (not $out
      and $typedef_rex and $type =~ s/($typedef_rex)/$typedefs_pre{$1}/go) {
    $type = normalize_type($type);
    print "Is-Pointer: Type mutation via typedefs: $otype ==&gt; $type\n"
      if $opt_d;
    $out = td_is_pointer($type);
  }
  return ($pointer_typedefs{$otype} = $out);
}</p>
<p>sub td_is_struct {
  my $type = shift;
  my $out = $struct_typedefs{$type};
  return $out if defined $out;
  my $otype = $type;
  $out = ($type =~ /^(struct|union)\b/) &amp;&amp; !td_is_pointer($type);
  # This converts only the guys which do not have trailing part in the typedef
  if (not $out
      and $typedef_rex and $type =~ s/($typedef_rex)/$typedefs_pre{$1}/go) {
    $type = normalize_type($type);
    print "Is-Struct: Type mutation via typedefs: $otype ==&gt; $type\n"
      if $opt_d;
    $out = td_is_struct($type);
  }
  return ($struct_typedefs{$otype} = $out);
}</p>
<p># Some macros will bomb if you try to return them from a double-returning func.
# Say, ((char *)0), or strlen (if somebody #define STRLEN strlen).
# Fortunately, we can detect both these cases...
sub protect_convert_to_double {
  my $in = shift;
  my $val;
  return '' unless defined ($val = $seen_define{$in});
  return '(IV)' if $known_fnames{$val};
  # OUT_t of ((OUT_t)-1):
  return '' unless $val =~ /^\s*(\(\s*)?\(\s*([^()]*?)\s*\)/;
  td_is_pointer($2) ? '(IV)' : '';
}</p>
<p># For each of the generated functions, length($pref) leading
# letters are already checked.  Moreover, it is recommended that
# the generated functions uses switch on letter at offset at least
# $off + length($pref).
#
# The given list has length($pref) chars removed at front, it is
# guarantied that $off leading chars in the rest are the same for all
# elts of the list.
#
# Returns: how at which offset it was decided to make a switch, or -1 if none.</p>
<p>sub write_const;</p>
<p>sub write_const {
  my ($fh, $pref, $off, $list) = (shift,shift,shift,shift);
  my %leading;
  my $offarg = length $pref;</p>
<pre class="verbatim"><ol><li>  if <span class="s">(</span><span class="i">@$list</span> == <span class="n">0</span><span class="s">)</span> <span class="s">{</span>		<span class="c"># Can happen on the initial iteration only</span></li><li>    <a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;&quot;END&quot;</span><span class="sc">;</span></li><li><span class="hh">static double</span></li><li><span class="hh">constant(char *name, int len, int arg)</span></li><li><span class="hh">{</span></li><li><span class="hh">    errno = EINVAL;</span></li><li><span class="hh">    return 0;</span></li><li><span class="hh">}</span></li><li><span class="h">END</span></li><li>    <a class="l_k" href="functions/return.html">return</a> <span class="n">-1</span><span class="sc">;</span></li><li>  <span class="s">}</span></li><li></li><li>  if <span class="s">(</span><span class="i">@$list</span> == <span class="n">1</span><span class="s">)</span> <span class="s">{</span>		<span class="c"># Can happen on the initial iteration only</span></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$protect</span> = <span class="i">protect_convert_to_double</span><span class="s">(</span><span class="q">&quot;$pref$list-&gt;[0]&quot;</span><span class="s">)</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;&quot;END&quot;</span><span class="sc">;</span></li><li><span class="hh">static double</span></li><li><span class="hh">constant(char *name, int len, int arg)</span></li><li><span class="hh">{</span></li><li><span class="hh">    errno = 0;</span></li><li><span class="hh">    if (strEQ(name + $offarg, &quot;$list-&gt;[0]&quot;)) {	/* $pref removed */</span></li><li><span class="hh">#ifdef $pref$list-&gt;[0]</span></li><li><span class="hh">	return $protect$pref$list-&gt;[0];</span></li><li><span class="hh">#else</span></li><li><span class="hh">	errno = ENOENT;</span></li><li><span class="hh">	return 0;</span></li><li><span class="hh">#endif</span></li><li><span class="hh">    }</span></li><li><span class="hh">    errno = EINVAL;</span></li><li><span class="hh">    return 0;</span></li><li><span class="hh">}</span></li><li><span class="h">END</span></li><li>    <a class="l_k" href="functions/return.html">return</a> <span class="n">-1</span><span class="sc">;</span></li><li>  <span class="s">}</span></li><li></li><li>  for <a class="l_k" href="functions/my.html">my</a> <span class="i">$n</span> <span class="s">(</span><span class="i">@$list</span><span class="s">)</span> <span class="s">{</span></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$c</span> = <a class="l_k" href="functions/substr.html">substr</a> <span class="i">$n</span><span class="cm">,</span> <span class="i">$off</span><span class="cm">,</span> <span class="n">1</span><span class="sc">;</span></li><li>    <span class="i">$leading</span>{<span class="i">$c</span>} = <span class="s">[</span><span class="s">]</span> unless <a class="l_k" href="functions/exists.html">exists</a> <span class="i">$leading</span>{<span class="i">$c</span>}<span class="sc">;</span></li><li>    <a class="l_k" href="functions/push.html">push</a> <span class="i">@</span>{<span class="i">$leading</span>{<span class="i">$c</span>}}<span class="cm">,</span> <a class="l_k" href="functions/substr.html">substr</a> <span class="i">$n</span><span class="cm">,</span> <span class="i">$off</span> + <span class="n">1</span><span class="sc">;</span></li><li>  <span class="s">}</span></li><li></li><li>  if <span class="s">(</span><a class="l_k" href="functions/keys.html">keys</a><span class="s">(</span><span class="i">%leading</span><span class="s">)</span> == <span class="n">1</span><span class="s">)</span> <span class="s">{</span></li><li>    <a class="l_k" href="functions/return.html">return</a> <span class="n">1</span> + <span class="w">write_const</span> <span class="i">$fh</span><span class="cm">,</span> <span class="i">$pref</span><span class="cm">,</span> <span class="i">$off</span> + <span class="n">1</span><span class="cm">,</span> <span class="i">$list</span><span class="sc">;</span></li><li>  <span class="s">}</span></li><li></li><li>  <a class="l_k" href="functions/my.html">my</a> <span class="i">$leader</span> = <a class="l_k" href="functions/substr.html">substr</a> <span class="i">$list</span>-&gt;[<span class="n">0</span>]<span class="cm">,</span> <span class="n">0</span><span class="cm">,</span> <span class="i">$off</span><span class="sc">;</span></li><li>  foreach <a class="l_k" href="functions/my.html">my</a> <span class="i">$letter</span> <span class="s">(</span><a class="l_k" href="functions/keys.html">keys</a> <span class="i">%leading</span><span class="s">)</span> <span class="s">{</span></li><li>    <span class="w">write_const</span> <span class="i">$fh</span><span class="cm">,</span> <span class="q">&quot;$pref$leader$letter&quot;</span><span class="cm">,</span> <span class="n">0</span><span class="cm">,</span> <span class="i">$leading</span>{<span class="i">$letter</span>}</li><li>      if <span class="i">@</span>{<span class="i">$leading</span>{<span class="i">$letter</span>}} &gt; <span class="n">1</span><span class="sc">;</span></li><li>  <span class="s">}</span></li><li></li><li>  <a class="l_k" href="functions/my.html">my</a> <span class="i">$npref</span> = <span class="q">&quot;_$pref&quot;</span><span class="sc">;</span></li><li>  <span class="i">$npref</span> = <span class="q">&#39;&#39;</span> if <span class="i">$pref</span> eq <span class="q">&#39;&#39;</span><span class="sc">;</span></li><li></li><li>  <a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;&quot;END&quot;</span><span class="sc">;</span></li><li><span class="hh">static double</span></li><li><span class="hh">constant$npref(char *name, int len, int arg)</span></li><li><span class="hh">{</span></li><li><span class="h">END</span></li><li></li><li>  <a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;&quot;END&quot;</span> if <span class="i">$npref</span> eq <span class="q">&#39;&#39;</span><span class="sc">;</span></li><li><span class="hh">    errno = 0;</span></li><li><span class="h">END</span></li><li></li><li>  <a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;&quot;END&quot;</span> if <span class="i">$off</span><span class="sc">;</span></li><li><span class="hh">    if ($offarg + $off &gt;= len ) {</span></li><li><span class="hh">	errno = EINVAL;</span></li><li><span class="hh">	return 0;</span></li><li><span class="hh">    }</span></li><li><span class="h">END</span></li><li></li><li>  <a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;&quot;END&quot;</span><span class="sc">;</span></li><li><span class="hh">    switch (name[$offarg + $off]) {</span></li><li><span class="h">END</span></li><li></li><li>  foreach <a class="l_k" href="functions/my.html">my</a> <span class="i">$letter</span> <span class="s">(</span><a class="l_k" href="functions/sort.html">sort</a> <a class="l_k" href="functions/keys.html">keys</a> <span class="i">%leading</span><span class="s">)</span> <span class="s">{</span></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$let</span> = <span class="i">$letter</span><span class="sc">;</span></li><li>    <span class="i">$let</span> = <span class="q">&#39;\0&#39;</span> if <span class="i">$letter</span> eq <span class="q">&#39;&#39;</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;EOP</span><span class="sc">;</span></li><li><span class="hh">    case &#39;$let&#39;:</span></li><li><span class="h">EOP</span></li><li>    if <span class="s">(</span><span class="i">@</span>{<span class="i">$leading</span>{<span class="i">$letter</span>}} &gt; <span class="n">1</span><span class="s">)</span> <span class="s">{</span></li><li>      <span class="c"># It makes sense to call a function</span></li><li>      if <span class="s">(</span><span class="i">$off</span><span class="s">)</span> <span class="s">{</span></li><li>	<a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;EOP</span><span class="sc">;</span></li><li><span class="hh">	if (!strnEQ(name + $offarg,&quot;$leader&quot;, $off))</span></li><li><span class="hh">	    break;</span></li><li><span class="h">EOP</span></li><li>      <span class="s">}</span></li><li>      <a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;EOP</span><span class="sc">;</span></li><li><span class="hh">	return constant_$pref$leader$letter(name, len, arg);</span></li><li><span class="h">EOP</span></li><li>    <span class="s">}</span></li><li>    else <span class="s">{</span></li><li>      <span class="c"># Do it ourselves</span></li><li>      <a class="l_k" href="functions/my.html">my</a> <span class="i">$protect</span></li><li>	= <span class="i">protect_convert_to_double</span><span class="s">(</span><span class="q">&quot;$pref$leader$letter$leading{$letter}[0]&quot;</span><span class="s">)</span><span class="sc">;</span></li><li></li><li>      <a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;EOP</span><span class="sc">;</span></li><li><span class="hh">	if (strEQ(name + $offarg, &quot;$leader$letter$leading{$letter}[0]&quot;)) {	/* $pref removed */</span></li><li><span class="hh">#ifdef $pref$leader$letter$leading{$letter}[0]</span></li><li><span class="hh">	    return $protect$pref$leader$letter$leading{$letter}[0];</span></li><li><span class="hh">#else</span></li><li><span class="hh">	    goto not_there;</span></li><li><span class="hh">#endif</span></li><li><span class="hh">	}</span></li><li><span class="h">EOP</span></li><li>    <span class="s">}</span></li><li>  <span class="s">}</span></li><li>  <a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;&quot;END&quot;</span><span class="sc">;</span></li><li><span class="hh">    }</span></li><li><span class="hh">    errno = EINVAL;</span></li><li><span class="hh">    return 0;</span></li></ol></pre><p>not_there:
    errno = ENOENT;
    return 0;
}</p>
<p>END</p>
<p>}</p>
<p>if( ! $opt_c ) {
  print XS &lt;&lt;"END";
static int
not_here(char *s)
{
    croak("$module::%s not implemented on this architecture", s);
    return -1;
}</p>
<p>END</p>
<pre class="verbatim"><ol><li>  <span class="i">write_const</span><span class="s">(</span>\<span class="i">*XS</span><span class="cm">,</span> <span class="q">&#39;&#39;</span><span class="cm">,</span> <span class="n">0</span><span class="cm">,</span> \<span class="i">@const_names</span><span class="s">)</span><span class="sc">;</span></li><li><span class="s">}</span></li></ol></pre><p>print_tievar_subs(\*XS, $_, $vdecl_hash{$_}) for @vdecls;</p>
<p>my $prefix;
$prefix = "PREFIX = $opt_p" if defined $opt_p;</p>
<p># Now switch from C to XS by issuing the first MODULE declaration:
print XS &lt;&lt;"END";</p>
<p>MODULE = $module		PACKAGE = $module		$prefix</p>
<p>END</p>
<p>foreach (sort keys %const_xsub) {
    print XS &lt;&lt;"END";
char *
$_()</p>
<pre class="verbatim"><ol><li>    <span class="j">CODE:</span></li><li><span class="c">#ifdef $_</span></li><li>	<span class="w">RETVAL</span> = <span class="i">$_</span><span class="sc">;</span></li><li><span class="c">#else</span></li><li>	<span class="i">croak</span><span class="s">(</span><span class="q">&quot;Your vendor has not defined the $module macro $_&quot;</span><span class="s">)</span><span class="sc">;</span></li><li><span class="c">#endif</span></li><li></li><li>    <span class="j">OUTPUT:</span></li><li>	<span class="w">RETVAL</span></li></ol></pre><p>END
}</p>
<p># If a constant() function was written then output a corresponding
# XS declaration:
print XS &lt;&lt;"END" unless $opt_c;</p>
<p>double
constant(sv,arg)
    PREINIT:
	STRLEN		len;
    INPUT:
	SV *		sv
	char *		s = SvPV(sv, len);
	int		arg
    CODE:
	RETVAL = constant(s,len,arg);
    OUTPUT:
	RETVAL</p>
<p>END</p>
<p>my %seen_decl;
my %typemap;</p>
<p>sub print_decl {
  my $fh = shift;
  my $decl = shift;
  my ($type, $name, $args) = @$decl;
  return if $seen_decl{$name}++; # Need to do the same for docs as well?</p>
<pre class="verbatim"><ol><li>  <a class="l_k" href="functions/my.html">my</a> <span class="i">@argnames</span> = <a class="l_k" href="functions/map.html">map</a> <span class="s">{</span><span class="i">$_</span>-&gt;[<span class="n">1</span>]<span class="s">}</span> <span class="i">@$args</span><span class="sc">;</span></li><li>  <a class="l_k" href="functions/my.html">my</a> <span class="i">@argtypes</span> = <a class="l_k" href="functions/map.html">map</a> <span class="s">{</span> <span class="i">normalize_type</span><span class="s">(</span> <span class="i">$_</span>-&gt;[<span class="n">0</span>]<span class="cm">,</span> <span class="n">1</span> <span class="s">)</span> <span class="s">}</span> <span class="i">@$args</span><span class="sc">;</span></li><li>  if <span class="s">(</span><span class="i">$opt_k</span><span class="s">)</span> <span class="s">{</span></li><li>    <span class="q">s/^\s*const\b\s*//</span> for <span class="i">@argtypes</span><span class="sc">;</span></li><li>  <span class="s">}</span></li><li>  <a class="l_k" href="functions/my.html">my</a> <span class="i">@argarrays</span> = <a class="l_k" href="functions/map.html">map</a> <span class="s">{</span> <span class="i">$_</span>-&gt;[<span class="n">4</span>] || <span class="q">&#39;&#39;</span> <span class="s">}</span> <span class="i">@$args</span><span class="sc">;</span></li><li>  <a class="l_k" href="functions/my.html">my</a> <span class="i">$numargs</span> = <span class="i">@$args</span><span class="sc">;</span></li><li>  if <span class="s">(</span><span class="i">$numargs</span> and <span class="i">$argtypes</span>[<span class="n">-1</span>] eq <span class="q">&#39;...&#39;</span><span class="s">)</span> <span class="s">{</span></li><li>    <span class="i">$numargs</span>--<span class="sc">;</span></li><li>    <span class="i">$argnames</span>[<span class="n">-1</span>] = <span class="q">&#39;...&#39;</span><span class="sc">;</span></li><li>  <span class="s">}</span></li><li>  <a class="l_k" href="functions/local.html">local</a> <span class="i">$&quot;</span> = <span class="q">&#39;, &#39;</span><span class="sc">;</span></li><li>  <span class="i">$type</span> = <span class="i">normalize_type</span><span class="s">(</span><span class="i">$type</span><span class="cm">,</span> <span class="n">1</span><span class="s">)</span><span class="sc">;</span></li><li></li><li>  <a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;&quot;EOP&quot;</span><span class="sc">;</span></li></ol></pre><p>$type
$name(@argnames)
EOP</p>
<pre class="verbatim"><ol><li>  for <a class="l_k" href="functions/my.html">my</a> <span class="i">$arg</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$numargs</span> - <span class="n">1</span><span class="s">)</span> <span class="s">{</span></li><li>    <a class="l_k" href="functions/print.html">print</a> <span class="i">$fh</span> <span class="h">&lt;&lt;&quot;EOP&quot;</span><span class="sc">;</span></li><li><span class="hh">	$argtypes[$arg]	$argnames[$arg]$argarrays[$arg]</span></li><li><span class="h">EOP</span></li><li>  <span class="s">}</span></li><li><span class="s">}</span></li></ol></pre><p>sub print_tievar_subs {
  my($fh, $name, $type) = @_;
  print $fh &lt;&lt;END;
I32
_get_$name(IV index, SV *sv) {
    dSP;
    PUSHMARK(SP);
    XPUSHs(sv);
    PUTBACK;
    (void)call_pv("$module\::_get_$name", G_DISCARD);
    return (I32)0;
}</p>
<p>I32
_set_$name(IV index, SV *sv) {
    dSP;
    PUSHMARK(SP);
    XPUSHs(sv);
    PUTBACK;
    (void)call_pv("$module\::_set_$name", G_DISCARD);
    return (I32)0;
}</p>
<p>END
}</p>
<p>sub print_tievar_xsubs {
  my($fh, $name, $type) = @_;
  print $fh &lt;&lt;END;
void
_tievar_$name(sv)
	SV* sv
    PREINIT:
	struct ufuncs uf;
    CODE:
	uf.uf_val = &amp;_get_$name;
	uf.uf_set = &amp;_set_$name;
	uf.uf_index = (IV)&amp;_get_$name;
	sv_magic(sv, 0, 'U', (char*)&amp;uf, sizeof(uf));</p>
<p>void
_get_$name(THIS)
	$type THIS = NO_INIT
    CODE:
	THIS = $name;
    OUTPUT:
	SETMAGIC: DISABLE
	THIS</p>
<p>void
_set_$name(THIS)
	$type THIS
    CODE:
	$name = THIS;</p>
<p>END
}</p>
<p>sub print_accessors {
  my($fh, $name, $struct) = @_;
  return unless defined $struct &amp;&amp; $name !~ /\s|_ANON/;
  $name = normalize_type($name);
  my $ptrname = normalize_type("$name *");
  print $fh &lt;&lt;"EOF";</p>
<p>MODULE = $module		PACKAGE = ${name}		$prefix</p>
<p>$name *
_to_ptr(THIS)
	$name THIS = NO_INIT
    PROTOTYPE: \$
    CODE:
	if (sv_derived_from(ST(0), "$name")) {
	    STRLEN len;
	    char *s = SvPV((SV*)SvRV(ST(0)), len);
	    if (len != sizeof(THIS))
		croak("Size \%d of packed data != expected \%d",
			len, sizeof(THIS));
	    RETVAL = ($name *)s;
	}   
	else
	    croak("THIS is not of type $name");
    OUTPUT:
	RETVAL</p>
<p>$name
new(CLASS)
	char *CLASS = NO_INIT
    PROTOTYPE: \$
    CODE:
	Zero((void*)&amp;RETVAL, sizeof(RETVAL), char);
    OUTPUT:
	RETVAL</p>
<p>MODULE = $module		PACKAGE = ${name}Ptr		$prefix</p>
<p>EOF
  my @items = @$struct;
  while (@items) {
    my $item = shift @items;
    if ($item-&gt;[0] =~ /_ANON/) {
      if (defined $item-&gt;[2]) {
	push @items, map [
	  @$_[0, 1], "$item-&gt;[2]_$_-&gt;[2]", "$item-&gt;[2].$_-&gt;[2]",
	], @{ $structs{$item-&gt;[0]} };
      } else {
	push @items, @{ $structs{$item-&gt;[0]} };
      }
    } else {
      my $type = normalize_type($item-&gt;[0]);
      my $ttype = $structs{$type} ? normalize_type("$type *") : $type;
      print $fh &lt;&lt;"EOF";
$ttype
$item-&gt;[2](THIS, __value = NO_INIT)
	$ptrname THIS
	$type __value
    PROTOTYPE: \$;\$
    CODE:
	if (items &gt; 1)
	    THIS-&gt;$item-&gt;[-1] = __value;
	RETVAL = @{[
	    $type eq $ttype ? "THIS-&gt;$item-&gt;[-1]" : "&amp;(THIS-&gt;$item-&gt;[-1])"
	]};
    OUTPUT:
	RETVAL</p>
<p>EOF
    }
  }
}</p>
<p># Should be called before any actual call to normalize_type().
sub get_typemap {
  # We do not want to read ./typemap by obvios reasons.
  my @tm =  qw(../../../typemap ../../typemap ../typemap);
  my $stdtypemap =  "$Config::Config{privlib}/ExtUtils/typemap";
  unshift @tm, $stdtypemap;
  my $proto_re = "[" . quotemeta('\$%&amp;*@;') . "]" ;</p>
<pre class="verbatim"><ol><li>  <span class="c"># Start with useful default values</span></li><li>  <span class="i">$typemap</span>{<span class="w">float</span>} = <span class="q">&#39;T_DOUBLE&#39;</span><span class="sc">;</span></li><li></li><li>  foreach <a class="l_k" href="functions/my.html">my</a> <span class="i">$typemap</span> <span class="s">(</span><span class="i">@tm</span><span class="s">)</span> <span class="s">{</span></li><li>    <a class="l_k" href="functions/next.html">next</a> unless -e <span class="i">$typemap</span> <span class="sc">;</span></li><li>    <span class="c"># skip directories, binary files etc.</span></li><li>    <a class="l_k" href="functions/warn.html">warn</a> <span class="q">&quot; Scanning $typemap\n&quot;</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/warn.html">warn</a><span class="s">(</span><span class="q">&quot;Warning: ignoring non-text typemap file &#39;$typemap&#39;\n&quot;</span><span class="s">)</span><span class="cm">,</span> <a class="l_k" href="functions/next.html">next</a> </li><li>      unless -T <span class="i">$typemap</span> <span class="sc">;</span></li><li>    <a class="l_k" href="functions/open.html">open</a><span class="s">(</span><span class="w">TYPEMAP</span><span class="cm">,</span> <span class="i">$typemap</span><span class="s">)</span> </li><li>      or <a class="l_k" href="functions/warn.html">warn</a> <span class="s">(</span><span class="q">&quot;Warning: could not open typemap file &#39;$typemap&#39;: $!\n&quot;</span><span class="s">)</span><span class="cm">,</span> <a class="l_k" href="functions/next.html">next</a><span class="sc">;</span></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$mode</span> = <span class="q">&#39;Typemap&#39;</span><span class="sc">;</span></li><li>    while <span class="s">(</span><span class="q">&lt;TYPEMAP&gt;</span><span class="s">)</span> <span class="s">{</span></li><li>      <a class="l_k" href="functions/next.html">next</a> if <span class="q">/^\s*\#/</span><span class="sc">;</span></li><li>      if <span class="s">(</span><span class="q">/^INPUT\s*$/</span><span class="s">)</span>   <span class="s">{</span> <span class="i">$mode</span> = <span class="q">&#39;Input&#39;</span><span class="sc">;</span> <a class="l_k" href="functions/next.html">next</a><span class="sc">;</span> <span class="s">}</span></li><li>      elsif <span class="s">(</span><span class="q">/^OUTPUT\s*$/</span><span class="s">)</span>  <span class="s">{</span> <span class="i">$mode</span> = <span class="q">&#39;Output&#39;</span><span class="sc">;</span> <a class="l_k" href="functions/next.html">next</a><span class="sc">;</span> <span class="s">}</span></li><li>      elsif <span class="s">(</span><span class="q">/^TYPEMAP\s*$/</span><span class="s">)</span> <span class="s">{</span> <span class="i">$mode</span> = <span class="q">&#39;Typemap&#39;</span><span class="sc">;</span> <a class="l_k" href="functions/next.html">next</a><span class="sc">;</span> <span class="s">}</span></li><li>      elsif <span class="s">(</span><span class="i">$mode</span> eq <span class="q">&#39;Typemap&#39;</span><span class="s">)</span> <span class="s">{</span></li><li>	<a class="l_k" href="functions/next.html">next</a> if <span class="q">/^\s*($|\#)/</span> <span class="sc">;</span></li><li>	<a class="l_k" href="functions/my.html">my</a> <span class="s">(</span><span class="i">$type</span><span class="cm">,</span> <span class="i">$image</span><span class="s">)</span><span class="sc">;</span></li><li>	if <span class="s">(</span> <span class="s">(</span><span class="i">$type</span><span class="cm">,</span> <span class="i">$image</span><span class="s">)</span> =</li><li>	     <span class="q">/^\s*(.*?\S)\s+(\S+)\s*($proto_re*)\s*$/o</span></li><li>	     <span class="c"># This may reference undefined functions:</span></li><li>	     and not <span class="s">(</span><span class="i">$image</span> eq <span class="q">&#39;T_PACKED&#39;</span> and <span class="i">$typemap</span> eq <span class="i">$stdtypemap</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span></li><li>	  <span class="i">$typemap</span>{<span class="i">normalize_type</span><span class="s">(</span><span class="i">$type</span><span class="s">)</span>} = <span class="i">$image</span><span class="sc">;</span></li><li>	<span class="s">}</span></li><li>      <span class="s">}</span></li><li>    <span class="s">}</span></li><li>    <a class="l_k" href="functions/close.html">close</a><span class="s">(</span><span class="w">TYPEMAP</span><span class="s">)</span> or <a class="l_k" href="functions/die.html">die</a> <span class="q">&quot;Cannot close $typemap: $!&quot;</span><span class="sc">;</span></li><li>  <span class="s">}</span></li><li>  <span class="i">%std_types</span> = <span class="i">%types_seen</span><span class="sc">;</span></li><li>  <span class="i">%types_seen</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span></li><li><span class="s">}</span></li></ol></pre><p>sub normalize_type {		# Second arg: do not strip const's before \*
  my $type = shift;
  my $do_keep_deep_const = shift;
  # If $do_keep_deep_const this is heuristical only
  my $keep_deep_const = ($do_keep_deep_const ? '\b(?![^(,)]*\*)' : '');
  my $ignore_mods 
    = "(?:\\b(?:(?:__const__|const)$keep_deep_const|static|inline|__inline__)\\b\\s*)*";
  if ($do_keep_deep_const) {	# Keep different compiled /RExen/o separately!
    $type =~ s/$ignore_mods//go;
  }
  else {
    $type =~ s/$ignore_mods//go;
  }
  $type =~ s/([^\s\w])/ \1 /g;
  $type =~ s/\s+$//;
  $type =~ s/^\s+//;
  $type =~ s/\s+/ /g;
  $type =~ s/\* (?=\*)/*/g;
  $type =~ s/\. \. \./.../g;
  $type =~ s/ ,/,/g;
  $types_seen{$type}++ 
    unless $type eq '...' or $type eq 'void' or $std_types{$type};
  $type;
}</p>
<p>my $need_opaque;</p>
<p>sub assign_typemap_entry {
  my $type = shift;
  my $otype = $type;
  my $entry;
  if ($tmask and $type =~ /$tmask/) {
    print "Type $type matches -o mask\n" if $opt_d;
    $entry = (td_is_struct($type) ? "T_OPAQUE_STRUCT" : "T_PTROBJ");
  }
  elsif ($typedef_rex and $type =~ s/($typedef_rex)/$typedefs_pre{$1}/go) {
    $type = normalize_type $type;
    print "Type mutation via typedefs: $otype ==&gt; $type\n" if $opt_d;
    $entry = assign_typemap_entry($type);
  }
  $entry ||= $typemap{$otype}
    || (td_is_struct($type) ? "T_OPAQUE_STRUCT" : "T_PTROBJ");
  $typemap{$otype} = $entry;
  $need_opaque = 1 if $entry eq "T_OPAQUE_STRUCT";
  return $entry;
}</p>
<p>for (@vdecls) {
  print_tievar_xsubs(\*XS, $_, $vdecl_hash{$_});
}</p>
<p>if ($opt_x) {
  for my $decl (@$fdecls_parsed) { print_decl(\*XS, $decl) }
  if ($opt_a) {
    while (my($name, $struct) = each %structs) {
      print_accessors(\*XS, $name, $struct);
    }
  }
}</p>
<p>close XS;</p>
<p>if (%types_seen) {
  my $type;
  warn "Writing $ext$modpname/typemap\n";
  open TM, "&gt;typemap" or die "Cannot open typemap file for write: $!";</p>
<pre class="verbatim"><ol><li>  for <span class="i">$type</span> <span class="s">(</span><a class="l_k" href="functions/sort.html">sort</a> <a class="l_k" href="functions/keys.html">keys</a> <span class="i">%types_seen</span><span class="s">)</span> <span class="s">{</span></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$entry</span> = <span class="w">assign_typemap_entry</span> <span class="i">$type</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/print.html">print</a> <span class="i">TM</span> <span class="i">$type</span><span class="cm">,</span> <span class="q">&quot;\t&quot;</span> x <span class="s">(</span><span class="n">5</span> - <a class="l_k" href="functions/int.html">int</a><span class="s">(</span><span class="s">(</span><a class="l_k" href="functions/length.html">length</a> <span class="i">$type</span><span class="s">)</span>/<span class="n">8</span><span class="s">)</span><span class="s">)</span><span class="cm">,</span> <span class="q">&quot;\t$entry\n&quot;</span></li><li>  <span class="s">}</span></li><li></li><li>  <a class="l_k" href="functions/print.html">print</a> <span class="i">TM</span> <span class="h">&lt;&lt;&#39;EOP&#39;</span> if <span class="i">$need_opaque</span><span class="sc">;</span> <span class="c"># Older Perls do not have correct entry</span></li><li><span class="hh">#############################################################################</span></li><li><span class="hh">INPUT</span></li><li><span class="hh">T_OPAQUE_STRUCT</span></li><li><span class="hh">	if (sv_derived_from($arg, \&quot;${ntype}\&quot;)) {</span></li><li><span class="hh">	    STRLEN len;</span></li><li><span class="hh">	    char  *s = SvPV((SV*)SvRV($arg), len);</span></li><li></li><li><span class="hh">	    if (len != sizeof($var))</span></li><li><span class="hh">		croak(\&quot;Size %d of packed data != expected %d\&quot;,</span></li><li><span class="hh">			len, sizeof($var));</span></li><li><span class="hh">	    $var = *($type *)s;</span></li><li><span class="hh">	}</span></li><li><span class="hh">	else</span></li><li><span class="hh">	    croak(\&quot;$var is not of type ${ntype}\&quot;)</span></li><li><span class="hh">#############################################################################</span></li><li><span class="hh">OUTPUT</span></li><li><span class="hh">T_OPAQUE_STRUCT</span></li><li><span class="hh">	sv_setref_pvn($arg, \&quot;${ntype}\&quot;, (char *)&amp;$var, sizeof($var));</span></li><li><span class="h">EOP</span></li><li></li><li>  <a class="l_k" href="functions/close.html">close</a> <span class="w">TM</span> or <a class="l_k" href="functions/die.html">die</a> <span class="q">&quot;Cannot close typemap file for write: $!&quot;</span><span class="sc">;</span></li><li><span class="s">}</span></li></ol></pre><p>} # if( ! $opt_X )</p>
<p>warn "Writing $ext$modpname/Makefile.PL\n";
open(PL, "&gt;Makefile.PL") || die "Can't create $ext$modpname/Makefile.PL: $!\n";</p>
<p>print PL &lt;&lt;END;
use ExtUtils::MakeMaker;
# See lib/ExtUtils/MakeMaker.pm for details of how to influence
# the contents of the Makefile that is written.
WriteMakefile(
    'NAME'		=&gt; '$module',
    'VERSION_FROM'	=&gt; '$modfname.pm', # finds \$VERSION
    'PREREQ_PM'		=&gt; {}, # e.g., Module::Name =&gt; 1.1
END
if (!$opt_X) { # print C stuff, unless XS is disabled
  $opt_F = '' unless defined $opt_F;
  print PL &lt;&lt;END;
    'LIBS'		=&gt; ['$extralibs'], # e.g., '-lm'
    'DEFINE'		=&gt; '$opt_F', # e.g., '-DHAVE_SOMETHING'
    'INC'		=&gt; '', # e.g., '-I/usr/include/other'
END
}
print PL ");\n";
close(PL) || die "Can't close $ext$modpname/Makefile.PL: $!\n";</p>
<p>warn "Writing $ext$modpname/test.pl\n";
open(EX, "&gt;test.pl") || die "Can't create $ext$modpname/test.pl: $!\n";
print EX &lt;&lt;'_END_';
# Before `make install' is performed this script should be runnable with
# `make test'. After `make install' it should work as `perl test.pl'</p>
<p>######################### We start with some black magic to print on failure.</p>
<p># Change 1..1 below to 1..last_test_to_print .
# (It may become useful if the test is moved to ./t subdirectory.)</p>
<p>BEGIN { $| = 1; print "1..1\n"; }
END {print "not ok 1\n" unless $loaded;}
_END_
print EX &lt;&lt;_END_;
use $module;
_END_
print EX &lt;&lt;'_END_';
$loaded = 1;
print "ok 1\n";</p>
<p>######################### End of black magic.</p>
<p># Insert your test code below (better if it prints "ok 13"
# (correspondingly "not ok 13") depending on the success of chunk 13
# of the test code):</p>
<p>_END_
close(EX) || die "Can't close $ext$modpname/test.pl: $!\n";</p>
<p>unless ($opt_C) {
  warn "Writing $ext$modpname/Changes\n";
  $" = ' ';
  open(EX, "&gt;Changes") || die "Can't create $ext$modpname/Changes: $!\n";
  @ARGS = map {/[\s\"\'\`\$*?^|&amp;&lt;&gt;\[\]\{\}\(\)]/ ? "'$_'" : $_} @ARGS;
  print EX &lt;&lt;EOP;
Revision history for Perl extension $module.</p>
<p>$TEMPLATE_VERSION  @{[scalar localtime]}
\t- original version; created by h2xs $H2XS_VERSION with options
\t\t@ARGS</p>
<p>EOP
  close(EX) || die "Can't close $ext$modpname/Changes: $!\n";
}</p>
<p>warn "Writing $ext$modpname/MANIFEST\n";
open(MANI,'&gt;MANIFEST') or die "Can't create MANIFEST: $!";
my @files = &lt;*&gt;;
if (!@files) {
  eval {opendir(D,'.');};
  unless ($@) { @files = readdir(D); closedir(D); }
}
if (!@files) { @files = map {chomp &amp;&amp; $_} `ls`; }
if ($^O eq 'VMS') {
  foreach (@files) {
    # Clip trailing '.' for portability -- non-VMS OSs don't expect it
    s%\.$%%;
    # Fix up for case-sensitive file systems
    s/$modfname/$modfname/i &amp;&amp; next;
    $_ = "\U$_" if $_ eq 'manifest' or $_ eq 'changes';
    $_ = 'Makefile.PL' if $_ eq 'makefile.pl';
  }
}
print MANI join("\n",@files), "\n";
close MANI;</p>




      <ul><li><a href="#NAME">NAME</a></li><li><a href="#SYNOPSIS">SYNOPSIS</a></li><li><a href="#DESCRIPTION">DESCRIPTION</a></li><li><a href="#OPTIONS">OPTIONS</a></li><li><a href="#EXAMPLES">EXAMPLES</a></li><li><a href="#ENVIRONMENT">ENVIRONMENT</a></li><li><a href="#AUTHOR">AUTHOR</a></li><li><a href="#SEE-ALSO">SEE ALSO</a></li><li><a href="#DIAGNOSTICS">DIAGNOSTICS</a></li><li><a href="#LIMITATIONS-of-*-x*">LIMITATIONS of *-x*</a></li><li><a href="#HISTORY">HISTORY</a></li><ul><li><a href="#EXPORT">EXPORT</a></li></ul></ul>


                  </div>
                </article>
              </div>
            </div>
          </main>
        </div>
           <footer class="footer row bg-light pt-5 pb-5">
       <div class="col-sm-10 offset-sm-1 col-xl-8 offset-xl-2">
           <div class="row">
               <div class="col-md-4">
                   <ul class="list-unstyled">
                       <li>
                           <h4>Site info</h4>
                       </li>
                       <li>Docs mantained by
                           <a href="//lists.perl.org/list/perl5-porters.html"
                               rel="noopener">Perl 5 Porters</a>
                       </li>
                       <li>Perldoc site development sponsored by
                           <a href="//opusvl.com" rel="noopener">
                           <img style="margin: 20px 20px 5px 10px" class="opus-logo" src="/public/img/opusvl_logo.svg" alt="OpusVL Logo">
                        </a>
                    <li><span class="about_perldoc"><a href="//about.html">About PerlDOC</a></span>
                    </li>
                       </li>
                   </ul>
               </div>
               <div class="col-md-8">
                   <div class="row">
                       <div class="col-md-6 col-lg-3">
                           <ul class=" list-unstyled">
                               <li>
                                   <h4>Manuals</h4>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/index-overview.html">Overview</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/index-tutorials.html">Tutorials</a>
                               </li>
                               <li>
                                   <a href="/5.6.0/index-faq.html">FAQs</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/index-history.html">Changes</a>
                               </li>
                           </ul>
                       </div>
                       <div class="col-md-6 col-lg-3">
                           <ul class=" list-unstyled">
                               <li>
                                   <h4>Reference</h4>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/index-language.html">Language</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/index-functions.html">Functions</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/perlop.html">Operators</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/perlvar.html">Variables</a>
                               </li>
                           </ul>
                       </div>
                       <div class="col-md-6 col-lg-3">
                           <ul class=" list-unstyled">
                               <li>
                                   <h4>Modules</h4>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/index-modules-A.html">Modules</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/index-pragmas.html">Pragmas</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/index-utilities.html">Utilities</a>
                               </li>
                           </ul>
                       </div>
                       <div class="col-md-6 col-lg-3">
                           <ul class=" list-unstyled">
                               <li>
                                   <h4>Misc</h4>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/index-licence.html">License</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/index-internals.html">Internals</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.6.0/index-platforms.html">Platforms</a>
                               </li>
                            <li>
                                <a
                                    href="/5.6.0/index-about.html">About</a>
                            </li>
                           </ul>
                       </div>
                   </div>
               </div>
               <div class=" col-12 footer-inf text-center">
                   <small>perldoc.perl.org - Official documentation for the Perl
                       programming language</small>
               </div>
           </div>
       </div>
   </footer>

        	<div class="beta-wrapper beta-bottom-right ">
		<div class="beta beta-blue  ">
			<a class="beta-link "
				href="//github.com/OpusVL/perldoc.perl.org/issues/new" rel="noopener">
				<span class="beta-text">
					This website is a Beta release.
				</span>
				<span class="beta-text">
					For any issues please raise a ticket on GitHub
				</span>
			</a>
		</div>
	</div>

        <script src="/public/js/main.min.js"></script>
      </body>

      </html>
