      
      
      
      

      <!DOCTYPE html>
      <html lang="en">

      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="perltodo - perldoc.perl.org">
        <link rel="icon" href="/public/img/favicon.ico">
        <title>perltodo - perldoc.perl.org</title>
        <link href="/public/css/main.min.css" rel="stylesheet">
        <link rel="canonical" href="/perltodo.html">
        <link
          href='https://fonts.googleapis.com/css?family=Lato:400,100,300,700,900'
          rel='stylesheet' type='text/css'>
        <script>
          window.ga = window.ga || function () {
            (ga.q = ga.q || []).push(arguments)
          };
          ga.l = +new Date;
          ga('create', 'UA-1892152-2', 'auto'); // JJ's account
          ga('create', 'UA-50555-3', 'auto', 'perlOrg'); // perl.org account
          ga('require', 'outboundLinkTracker', {
            events: ['click', 'auxclick', 'contextmenu'],
          });
          ga('require', 'maxScrollTracker');
          ga('send', 'pageview');
          ga('perlOrg.send', 'pageview');
        </script>
        <script async src="https://www.google-analytics.com/analytics.js">
        </script>
        <script async src="/public/js/tracking.min.js"></script>
      </head>

      <body class="body container-fluid ">
        <div class="wrapper">

          <nav
    class="navbar navbar-dark bg-primary bg-perl fixed-top justify-content-between navbar-expand-lg">
    <a href="#content" class="skippy sr-only sr-only-focusable">
        <span class=' skippy-text'>Skip to main content</span>
    </a>
    <a class="navbar-brand" href="/">
        <img class="logo" src="/public/img/logo_perl_doc.svg"
            alt="Perl Documentation Logo" />
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse"
        data-target="#navbar" aria-controls="navbar" aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div id="navbar" class="collapse navbar-collapse ">
        <ul class="navbar-nav ml-auto navbar-right">
            <form class="nav-item dropdown search-wrapper">
                <input type="text" id='searchinput' aria-describedby='navbarDropdown5'
                    placeholder="Type query" class='search-input-field' value=''>

                <button href="#" data-toggle='dropdown' type="button"
                    aria-haspopup="true" aria-expanded='false' id="navbarDropdown5"
                    class="nav-link dropdown-toggle search-link">
                    <object tabindex='-1' focusable="false" class='search-icon'
                        data="/public/img/search.svg" type="image/svg+xml"
                        name='search icon'>search
                        icon</object>
                </button>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown5"
                    id='search-results'>
                    <p class='dropdown-item major-version'>
                        No results
                    </p>
                </div>
            </form>
            <li class="nav-item dropdown">
                <a id="navbarDropdown" href="#" class="nav-link dropdown-toggle"
                    data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false">Perl versions</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    
                        <p class='dropdown-item major-version'>
                            5.32
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.32.0/">5.32.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.30
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.30.3/">5.30.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.30.2/">5.30.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.30.1/">5.30.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.30.0/">5.30.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.28
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.28.3/">5.28.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.28.2/">5.28.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.28.1/">5.28.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.28.0/">5.28.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.26
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.26.3/">5.26.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.26.2/">5.26.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.26.1/">5.26.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.26.0/">5.26.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.24
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.24.4/">5.24.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.24.3/">5.24.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.24.2/">5.24.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.24.1/">5.24.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.24.0/">5.24.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.22
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.22.4/">5.22.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.22.3/">5.22.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.22.2/">5.22.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.22.1/">5.22.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.22.0/">5.22.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.20
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.20.3/">5.20.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.20.2/">5.20.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.20.1/">5.20.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.20.0/">5.20.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.18
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.18.4/">5.18.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.18.3/">5.18.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.18.2/">5.18.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.18.1/">5.18.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.18.0/">5.18.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.16
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.16.3/">5.16.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.16.2/">5.16.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.16.1/">5.16.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.16.0/">5.16.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.14
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.14.4/">5.14.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.14.3/">5.14.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.14.2/">5.14.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.14.1/">5.14.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.14.0/">5.14.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.12
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.12.5/">5.12.5</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.4/">5.12.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.3/">5.12.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.2/">5.12.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.1/">5.12.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.12.0/">5.12.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.10
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.10.1/">5.10.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.10.0/">5.10.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.8
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.8.9/">5.8.9</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.8/">5.8.8</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.7/">5.8.7</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.6/">5.8.6</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.5/">5.8.5</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.4/">5.8.4</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.3/">5.8.3</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.2/">5.8.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.1/">5.8.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.8.0/">5.8.0</a>
                        
                        
                        <div class="dropdown-divider"></div>
                        
                    
                        <p class='dropdown-item major-version'>
                            5.6
                        </p>
                        
                        <a class='dropdown-item minor-version' href="/5.6.2/">5.6.2</a>
                        
                        <a class='dropdown-item minor-version' href="/5.6.1/">5.6.1</a>
                        
                        <a class='dropdown-item minor-version' href="/5.6.0/">5.6.0</a>
                        
                        
                    
                </div>
            </li>
            <li class="nav-item dropdown">
                <a id="navbarDropdown1" href="#" class="dropdown-toggle nav-link"
                    data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false">Manuals</a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown1">
                    <a class="dropdown-item"
                        href="/5.8.9/index-overview.html">Overview</a>
                    <a class="dropdown-item"
                        href="/5.8.9/index-tutorials.html">Tutorials</a>
                    <a class="dropdown-item"
                        href="/5.8.9/index-faq.html">FAQs</a>
                    <a class="dropdown-item"
                        href="/5.8.9/index-history.html">Changes</a>
                    <a class="dropdown-item"
                        href="/5.8.9/index-licence.html">License</a>
                    <a class="dropdown-item"
                        href="/5.8.9/index-language.html">Language</a>
                    <a class="dropdown-item"
                        href="/5.8.9/index-functions.html">Functions</a>
                    <a class="dropdown-item"
                        href="/5.8.9/perlop.html">Operators</a>
                    <a class="dropdown-item"
                        href="/5.8.9/perlvar.html">Variables</a>
                    <a class="dropdown-item"
                        href="/5.8.9/index-pragmas.html">Pragmas</a>
                    <a class="dropdown-item"
                        href="/5.8.9/index-utilities.html">Utilities</a>
                    <a class="dropdown-item"
                        href="/5.8.9/index-internals.html">Internals</a>
                    <a class="dropdown-item"
                        href="/5.8.9/index-platforms.html">Platforms</a>
                </div>
            </li>
            <li class="nav-item dropdown">
                <a id="navbarDropdown3" href="#" class="nav-link dropdown-toggle "
                    data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false">Modules</a>
                <div aria-labelledby="navbarDropdown3"
                    class="dropdown-menu letters-wrap">
                    <!--<a class="dropdown-item"
                        href="/5.8.9/index-modules.html">A-Z</a>
                    <a class="dropdown-item"
                        href="/5.8.9/index-modules-by-cat.html">By
                        Category</a>-->
                    <div class="dropdown-divider"></div>
                    <div class="letter-container">
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-A.html">A</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-B.html">B</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-C.html">C</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-D.html">D</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-E.html">E</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-F.html">F</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-G.html">G</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-H.html">H</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-I.html">I</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-J.html">J</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-K.html">K</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-L.html">L</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-M.html">M</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-N.html">N</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-O.html">O</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-P.html">P</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-Q.html">Q</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-R.html">R</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-S.html">S</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-T.html">T</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-U.html">U</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-V.html">V</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-W.html">W</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-X.html">X</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-Y.html">Y</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-modules-Z.html">Z</a>
                    </div>
                </div>
            </li>
            <li class="nav-item dropdown">
                <a id="navbarDropdown4" href="#" class="nav-link dropdown-toggle "
                    data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false">Functions</a>
                <div aria-labelledby="navbarDropdown4"
                    class="dropdown-menu letters-wrap">
                    <a class="dropdown-item"
                        href="/5.8.9/index-functions.html">A-Z</a>
                    <a class="dropdown-item"
                        href="/5.8.9/index-functions-by-cat.html">By
                        Category</a>
                    <div class="dropdown-divider"></div>
                    <div class="letter-container">
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#A">A</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#B">B</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#C">C</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#D">D</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#E">E</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#F">F</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#G">G</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#H">H</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#I">I</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#J">J</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#K">K</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#L">L</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#M">M</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#N">N</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#O">O</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#P">P</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#Q">Q</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#R">R</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#S">S</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#T">T</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#U">U</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#V">V</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#W">W</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#X">X</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#Y">Y</a>
                        <a class="dropdown-item letters"
                            href="/5.8.9/index-functions.html#Z">Z</a>
                    </div>
                </div>
            </li>
        </ul>
    </div>
    <!--/.nav-collapse -->
</nav>


          <main class="row main-content pb-5 pt-5" id='content'>
            <div class="col-sm-10 offset-sm-1 col-xl-8 offset-xl-2">
              <div class="row">
                <div class="col-sm-12">
                  <div id="breadcrumbs">
                      
    <a href="index.html">Home</a>&nbsp; &gt;
    
      
        <a href="index-history.html">History / Changes</a> &gt;
      
    
    perltodo
  

                  </div>
                </div>
              </div>
              <div class="row">
                <article class="col-sm-12 content">
                  <div class="documentation-wrapper">
                    <div id="perl_version">
                      <h7 class='page-title'> Perl 5 version 8.9
                        documentation</h7>
                    </div>
                    <h1>perltodo</h1>


  <!--    -->
<ul><li><a href="#NAME">NAME</a></li><li><a href="#DESCRIPTION">DESCRIPTION</a></li><li><a href="#Tasks-that-only-need-Perl-knowledge">Tasks that only need Perl knowledge</a></li><ul><li><a href="#Smartmatch-design-issues">Smartmatch design issues</a></li><li><a href="#Remove-duplication-of-test-setup.">Remove duplication of test setup.</a></li><li><a href="#POD--%3e-HTML-conversion-in-the-core-still-sucks">POD -> HTML conversion in the core still sucks</a></li><li><a href="#merge-checkpods-and-podchecker">merge checkpods and podchecker</a></li><li><a href="#Parallel-testing">Parallel testing</a></li><li><a href="#Make-Schwern-poorer">Make Schwern poorer</a></li><li><a href="#Improve-the-coverage-of-the-core-tests">Improve the coverage of the core tests</a></li><li><a href="#test-B">test B</a></li><li><a href="#Deparse-inlined-constants">Deparse inlined constants</a></li><li><a href="#A-decent-benchmark">A decent benchmark</a></li><li><a href="#fix-tainting-bugs">fix tainting bugs</a></li><li><a href="#Dual-life-everything">Dual life everything</a></li><li><a href="#Bundle-dual-life-modules-in-ext%2f">Bundle dual life modules in ext/</a></li><li><a href="#POSIX-memory-footprint">POSIX memory footprint</a></li><li><a href="#embed.pl%2fmakedef.pl">embed.pl/makedef.pl</a></li><li><a href="#use-strict%3b-and-AutoLoad">use strict; and AutoLoad</a></li><li><a href="#profile-installman">profile installman</a></li></ul><li><a href="#Tasks-that-need-a-little-sysadmin-type-knowledge">Tasks that need a little sysadmin-type knowledge</a></li><ul><li><a href="#make-HTML-install-work">make HTML install work</a></li><li><a href="#compressed-man-pages">compressed man pages</a></li><li><a href="#Add-a-code-coverage-target-to-the-Makefile">Add a code coverage target to the Makefile</a></li><li><a href="#Make-Config.pm-cope-with-differences-between-built-and-installed-perl">Make Config.pm cope with differences between built and installed perl</a></li><li><a href="#linker-specification-files">linker specification files</a></li><li><a href="#Cross-compile-support">Cross-compile support</a></li><li><a href="#roffitall">roffitall</a></li><li><a href="#Split-%22linker%22-from-%22compiler%22">Split "linker" from "compiler"</a></li></ul><li><a href="#Tasks-that-need-a-little-C-knowledge">Tasks that need a little C knowledge</a></li><ul><li><a href="#Weed-out-needless-PERL_UNUSED_ARG">Weed out needless PERL_UNUSED_ARG</a></li><li><a href="#Modernize-the-order-of-directories-in-%40INC">Modernize the order of directories in @INC</a></li><li><a href="#-Duse32bit*">-Duse32bit*</a></li><li><a href="#Make-it-clear-from--v-if-this-is-the-exact-official-release">Make it clear from -v if this is the exact official release</a></li><li><a href="#Profile-Perl---am-I-hot-or-not%3f">Profile Perl - am I hot or not?</a></li><li><a href="#Allocate-OPs-from-arenas">Allocate OPs from arenas</a></li><li><a href="#Improve-win32%2fwince.c">Improve win32/wince.c</a></li><li><a href="#Use-secure-CRT-functions-when-building-with-VC8-on-Win32">Use secure CRT functions when building with VC8 on Win32</a></li><li><a href="#Fix-POSIX%3a%3aaccess()-and-chdir()-on-Win32">Fix POSIX::access() and chdir() on Win32</a></li><li><a href="#strcat()%2c-strcpy()%2c-strncat()%2c-strncpy()%2c-sprintf()%2c-vsprintf()">strcat(), strcpy(), strncat(), strncpy(), sprintf(), vsprintf()</a></li><li><a href="#-D_FORTIFY_SOURCE%3d2%2c--fstack-protector">-D_FORTIFY_SOURCE=2, -fstack-protector</a></li><li><a href="#Arenas-for-GPs%3f-For-MAGIC%3f">Arenas for GPs? For MAGIC?</a></li><li><a href="#Shared-arenas">Shared arenas</a></li></ul><li><a href="#Tasks-that-need-a-knowledge-of-XS">Tasks that need a knowledge of XS</a></li><ul><li><a href="#investigate-removing-int_macro_int-from-POSIX.xs">investigate removing int_macro_int from POSIX.xs</a></li><li><a href="#safely-supporting-POSIX-SA_SIGINFO">safely supporting POSIX SA_SIGINFO</a></li><li><a href="#autovivification">autovivification</a></li><li><a href="#Unicode-in-Filenames">Unicode in Filenames</a></li><li><a href="#Unicode-in-%25ENV">Unicode in %ENV</a></li><li><a href="#Unicode-and-glob()">Unicode and glob()</a></li><li><a href="#Unicode-and-lc%2fuc-operators">Unicode and lc/uc operators</a></li><li><a href="#use-less-'memory'">use less 'memory'</a></li><li><a href="#Re-implement-%3aunique-in-a-way-that-is-actually-thread-safe">Re-implement :unique in a way that is actually thread-safe</a></li><li><a href="#Make-tainting-consistent">Make tainting consistent</a></li><li><a href="#readpipe(LIST)">readpipe(LIST)</a></li><li><a href="#Audit-the-code-for-destruction-ordering-assumptions">Audit the code for destruction ordering assumptions</a></li><li><a href="#Extend-PerlIO-and-PerlIO%3a%3aScalar">Extend PerlIO and PerlIO::Scalar</a></li><li><a href="#-C-on-the-%23!-line">-C on the #! line</a></li><li><a href="#Propagate-const-outwards-from-Perl_moreswitches()">Propagate const outwards from Perl_moreswitches()</a></li><li><a href="#Duplicate-logic-in-S_method_common()-and-Perl_gv_fetchmethod_autoload()">Duplicate logic in S_method_common() and Perl_gv_fetchmethod_autoload()</a></li><li><a href="#Organize-error-messages">Organize error messages</a></li></ul><li><a href="#Tasks-that-need-a-knowledge-of-the-interpreter">Tasks that need a knowledge of the interpreter</a></li><ul><li><a href="#error-reporting-of-%5b%24a-%3b-%24b%5d">error reporting of [$a ; $b]</a></li><li><a href="#UTF-8-revamp">UTF-8 revamp</a></li><li><a href="#Properly-Unicode-safe-tokeniser-and-pads.">Properly Unicode safe tokeniser and pads.</a></li><li><a href="#state-variable-initialization-in-list-context">state variable initialization in list context</a></li><li><a href="#Implement-%24value-~~-0-..-%24range">Implement $value ~~ 0 .. $range</a></li><li><a href="#A-does()-built-in">A does() built-in</a></li><li><a href="#Tied-filehandles-and-write()-don't-mix">Tied filehandles and write() don't mix</a></li><li><a href="#Attach%2fdetach-debugger-from-running-program">Attach/detach debugger from running program</a></li><li><a href="#Optimize-away-empty-destructors">Optimize away empty destructors</a></li><li><a href="#LVALUE-functions-for-lists">LVALUE functions for lists</a></li><li><a href="#LVALUE-functions-in-the-debugger">LVALUE functions in the debugger</a></li><li><a href="#regexp-optimiser-optional">regexp optimiser optional</a></li><li><a href="#delete-%26function">delete &function</a></li><li><a href="#%2fw-regex-modifier">/w regex modifier</a></li><li><a href="#optional-optimizer">optional optimizer</a></li><li><a href="#You-WANT-*how*-many">You WANT *how* many</a></li><li><a href="#lexical-aliases">lexical aliases</a></li><li><a href="#entersub-XS-vs-Perl">entersub XS vs Perl</a></li><li><a href="#Self-ties">Self-ties</a></li><li><a href="#Optimize-away-%40_">Optimize away @_</a></li><li><a href="#The-yada-yada-yada-operators">The yada yada yada operators</a></li><li><a href="#Virtualize-operating-system-access">Virtualize operating system access</a></li><li><a href="#Investigate-PADTMP-hash-pessimisation">Investigate PADTMP hash pessimisation</a></li><li><a href="#Store-the-current-pad-in-the-OP-slab-allocator">Store the current pad in the OP slab allocator</a></li><li><a href="#repack-the-optree">repack the optree</a></li><li><a href="#eliminate-incorrect-line-numbers-in-warnings">eliminate incorrect line numbers in warnings</a></li><li><a href="#optimize-tail-calls">optimize tail-calls</a></li></ul><li><a href="#Big-projects">Big projects</a></li><ul><li><a href="#make-ithreads-more-robust">make ithreads more robust</a></li><li><a href="#iCOW">iCOW</a></li><li><a href="#(%3f%7b...%7d)-closures-in-regexps">(?{...}) closures in regexps</a></li><li><a href="#A-re-entrant-regexp-engine">A re-entrant regexp engine</a></li><li><a href="#Add-class-set-operations-to-regexp-engine">Add class set operations to regexp engine</a></li></ul></ul><a class='view-head1' id="NAME"></a><h2 class='h2' >NAME</h2>
<p>perltodo - Perl TO-DO List</p>
<a class='view-head1' id="DESCRIPTION"></a><h2 class='h2' >DESCRIPTION</h2>
<p>This is a list of wishes for Perl. The tasks we think are smaller or
easier are listed first. Anyone is welcome to work on any of these,
but it's a good idea to first contact <i>perl5-porters@perl.org</i> to
avoid duplication of effort, and to learn from any previous attempts.
By all means contact a pumpking privately first if you prefer.</p>
<p>Whilst patches to make the list shorter are most welcome, ideas to add to
the list are also encouraged. Check the perl5-porters archives for past
ideas, and any discussion about them. One set of archives may be found at:</p>
<pre class="verbatim"><ol><li>    <span class="j">http:</span><span class="q">//</span><span class="w">www</span>.<span class="w">xray</span>.<span class="w">mpe</span>.<span class="w">mpg</span>.<span class="w">de</span>/<span class="w">mailing</span>-<span class="w">lists</span><span class="q">/perl5-porters/</span></li></ol></pre><p>What can we offer you in return? Fame, fortune, and everlasting glory? Maybe
not, but if your patch is incorporated, then we'll add your name to the
<i>AUTHORS</i> file, which ships in the official distribution. How many other
programming languages offer you 1 line of immortality?</p>
<a class='view-head1' id="Tasks-that-only-need-Perl-knowledge"></a><h2 class='h2' >Tasks that only need Perl knowledge</h2>
<a class='view-head2' id="Smartmatch-design-issues"></a><h3 class='h3' >Smartmatch design issues</h3>
<p>In 5.10.0 the smartmatch operator <code class="inline">~~</code>
 isn't working quite "right". But
before we can fix the implementation, we need to define what "right" is.
The first problem is that Robin Houston implemented the Perl 6 smart match
spec as of February 2006, when smart match was axiomatically symmetrical:
<a href="http://groups.google.com/group/perl.perl6.language/msg/bf2b486f089ad021">http://groups.google.com/group/perl.perl6.language/msg/bf2b486f089ad021</a></p>
<p>Since then the Perl 6 target moved, but the Perl 5 implementation did not.</p>
<p>So it would be useful for someone to compare the Perl 6 smartmatch table
as of February 2006 <a href="http://svn.perl.org/viewvc/perl6/doc/trunk/design/syn/S03.pod?view=markup&amp;pathrev=7615">http://svn.perl.org/viewvc/perl6/doc/trunk/design/syn/S03.pod?view=markup&amp;pathrev=7615</a>
and the current table <a href="http://svn.perl.org/viewvc/perl6/doc/trunk/design/syn/S03.pod?revision=14556&amp;view=markup">http://svn.perl.org/viewvc/perl6/doc/trunk/design/syn/S03.pod?revision=14556&amp;view=markup</a>
and tabulate the differences in Perl 6. The annotated view of changes is
<a href="http://svn.perl.org/viewvc/perl6/doc/trunk/design/syn/S03.pod?view=annotate">http://svn.perl.org/viewvc/perl6/doc/trunk/design/syn/S03.pod?view=annotate</a> and the diff is
<code class="inline">svn diff -r7615:14556 <a href="http://svn.perl.org/perl6/doc/trunk/design/syn/S03.pod">http://svn.perl.org/perl6/doc/trunk/design/syn/S03.pod</a></code>
-- search for <code class="inline"><span class="pd">=head1 Smart matching</span></code>
. (In theory <i>viewvc</i> can generate that,
but in practice when I tried it hung forever, I assume "thinking")</p>
<p>With that done and published, someone (else) can then map any changed Perl 6
semantics back to Perl 5, based on how the existing semantics map to Perl 5:
<a href="http://search.cpan.org/~rgarcia/perl-5.10.0/pod/perlsyn.pod#Smart_matching_in_detail">http://search.cpan.org/~rgarcia/perl-5.10.0/pod/perlsyn.pod#Smart_matching_in_detail</a></p>
<p>There are also some questions that need answering:</p>
<ul>
<li>
<p>How do you negate one?  (documentation issue)
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2008-01/msg00071.html">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2008-01/msg00071.html</a></p>
</li>
<li>
<p>Array behaviors
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2007-12/msg00799.html">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2007-12/msg00799.html</a></p>
<p>* Should smart matches be symmetrical? (Perl 6 says no)</p>
<p>* Other differences between Perl 5 and Perl 6 smart match?</p>
</li>
<li>
<p>Objects and smart match
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2007-12/msg00865.html">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2007-12/msg00865.html</a></p>
</li>
</ul>
<a class='view-head2' id="Remove-duplication-of-test-setup."></a><h3 class='h3' >Remove duplication of test setup.</h3>
<p>Schwern notes, that there's duplication of code - lots and lots of tests have
some variation on the big block of <code class="inline"><span class="i">$Is_Foo</span></code>
 checks.  We can safely put this
into a file, change it to build an <code class="inline"><span class="i">%Is</span></code>
 hash and require it.  Maybe just put
it into <i>test.pl</i>. Throw in the handy tainting subroutines.</p>
<a class='view-head2' id="POD--%3e-HTML-conversion-in-the-core-still-sucks"></a><h3 class='h3' >POD -&gt; HTML conversion in the core still sucks</h3>
<p>Which is crazy given just how simple POD purports to be, and how simple HTML
can be. It's not actually <i>as</i> simple as it sounds, particularly with the
flexibility POD allows for <code class="inline"><span class="pd">=item</span></code>
, but it would be good to improve the
visual appeal of the HTML generated, and to avoid it having any validation
errors. See also <a href="#make-HTML-install-work">make HTML install work</a>, as the layout of installation tree
is needed to improve the cross-linking.</p>
<p>The addition of <code class="inline"><span class="w">Pod::Simple</span></code>
 and its related modules may make this task
easier to complete.</p>
<a class='view-head2' id="merge-checkpods-and-podchecker"></a><h3 class='h3' >merge checkpods and podchecker</h3>
<p><i>pod/checkpods.PL</i> (and <code class="inline"><span class="w">make</span> <span class="w">check</span></code>
 in the <i>pod/</i> subdirectory)
implements a very basic check for pod files, but the errors it discovers
aren't found by podchecker. Add this check to podchecker, get rid of
checkpods and have <code class="inline"><span class="w">make</span> <span class="w">check</span></code>
 use podchecker.</p>
<a class='view-head2' id="Parallel-testing"></a><h3 class='h3' >Parallel testing</h3>
<p>(This probably impacts much more than the core: also the Test::Harness
and TAP::* modules on CPAN.)</p>
<p>All of the tests in <i>t/</i> can now be run in parallel, if <code class="inline"><span class="i">$ENV</span>{<span class="w">TEST_JOBS</span>}</code>

is set. However, tests within each directory in <i>ext</i> and <i>lib</i> are still
run in series, with directories run in parallel. This is an adequate
heuristic, but it might be possible to relax it further, and get more
throughput. Specifically, it would be good to audit all of <i>lib/*.t</i>, and
make them use <code class="inline"><span class="w">File::Temp</span></code>
.</p>
<a class='view-head2' id="Make-Schwern-poorer"></a><h3 class='h3' >Make Schwern poorer</h3>
<p>We should have tests for everything. When all the core's modules are tested,
Schwern has promised to donate to $500 to TPF. We may need volunteers to
hold him upside down and shake vigorously in order to actually extract the
cash.</p>
<a class='view-head2' id="Improve-the-coverage-of-the-core-tests"></a><h3 class='h3' >Improve the coverage of the core tests</h3>
<p>Use Devel::Cover to ascertain the core modules's test coverage, then add
tests that are currently missing.</p>
<a class='view-head2' id="test-B"></a><h3 class='h3' >test B</h3>
<p>A full test suite for the B module would be nice.</p>
<a class='view-head2' id="Deparse-inlined-constants"></a><h3 class='h3' >Deparse inlined constants</h3>
<p>Code such as this</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/use.html">use</a> <span class="w">constant</span> <span class="i">PI</span> <span class="cm">=&gt;</span> <span class="n">4</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/warn.html">warn</a> <span class="i">PI</span></li></ol></pre><p>will currently deparse as</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/use.html">use</a> <span class="w">constant</span> <span class="s">(</span><span class="q">&#39;PI&#39;</span><span class="cm">,</span> <span class="n">4</span><span class="s">)</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/warn.html">warn</a> <span class="n">4</span><span class="sc">;</span></li></ol></pre><p>because the tokenizer inlines the value of the constant subroutine <code class="inline"><span class="w">PI</span></code>
.
This allows various compile time optimisations, such as constant folding
and dead code elimination. Where these haven't happened (such as the example
above) it ought be possible to make B::Deparse work out the name of the
original constant, because just enough information survives in the symbol
table to do this. Specifically, the same scalar is used for the constant in
the optree as is used for the constant subroutine, so by iterating over all
symbol tables and generating a mapping of SV address to constant name, it
would be possible to provide B::Deparse with this functionality.</p>
<a class='view-head2' id="A-decent-benchmark"></a><h3 class='h3' >A decent benchmark</h3>
<p><code class="inline"><span class="w">perlbench</span></code>
 seems impervious to any recent changes made to the perl core. It
would be useful to have a reasonable general benchmarking suite that roughly
represented what current perl programs do, and measurably reported whether
tweaks to the core improve, degrade or don't really affect performance, to
guide people attempting to optimise the guts of perl. Gisle would welcome
new tests for perlbench.</p>
<a class='view-head2' id="fix-tainting-bugs"></a><h3 class='h3' >fix tainting bugs</h3>
<p>Fix the bugs revealed by running the test suite with the <code class="inline">-t</code>
 switch (via
<code class="inline"><span class="w">make</span> <span class="w">test</span>.<span class="w">taintwarn</span></code>
).</p>
<a class='view-head2' id="Dual-life-everything"></a><h3 class='h3' >Dual life everything</h3>
<p>As part of the "dists" plan, anything that doesn't belong in the smallest perl
distribution needs to be dual lifed. Anything else can be too. Figure out what
changes would be needed to package that module and its tests up for CPAN, and
do so. Test it with older perl releases, and fix the problems you find.</p>
<p>To make a minimal perl distribution, it's useful to look at
<i>t/lib/commonsense.t</i>.</p>
<a class='view-head2' id="Bundle-dual-life-modules-in-ext%2f"></a><h3 class='h3' >Bundle dual life modules in ext/</h3>
<p>For maintenance (and branch merging) reasons, it would be useful to move
some architecture-independent dual-life modules from lib/ to ext/, if this
has no negative impact on the build of perl itself.</p>
<a class='view-head2' id="POSIX-memory-footprint"></a><h3 class='h3' >POSIX memory footprint</h3>
<p>Ilya observed that use POSIX; eats memory like there's no tomorrow, and at
various times worked to cut it down. There is probably still fat to cut out -
for example POSIX passes Exporter some very memory hungry data structures.</p>
<a class='view-head2' id="embed.pl%2fmakedef.pl"></a><h3 class='h3' >embed.pl/makedef.pl</h3>
<p>There is a script <i>embed.pl</i> that generates several header files to prefix
all of Perl's symbols in a consistent way, to provide some semblance of
namespace support in <code class="inline"><span class="w">C</span></code>
. Functions are declared in <i>embed.fnc</i>, variables
in <i>interpvar.h</i>. Quite a few of the functions and variables
are conditionally declared there, using <code class="inline"><span class="c">#ifdef</span></code>
. However, <i>embed.pl</i>
doesn't understand the C macros, so the rules about which symbols are present
when is duplicated in <i>makedef.pl</i>. Writing things twice is bad, m'kay.
It would be good to teach <code class="inline"><span class="w">embed</span>.<span class="w">pl</span></code>
 to understand the conditional
compilation, and hence remove the duplication, and the mistakes it has caused.</p>
<a class='view-head2' id="use-strict%3b-and-AutoLoad"></a><h3 class='h3' >use strict; and AutoLoad</h3>
<p>Currently if you write</p>
<pre class="verbatim"><ol><li><a name="package-Whack"></a>    package <span class="i">Whack</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/use.html">use</a> <span class="w">AutoLoader</span> <span class="q">&#39;AUTOLOAD&#39;</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/use.html">use</a> <span class="w">strict</span><span class="sc">;</span></li><li>    <span class="n">1</span><span class="sc">;</span></li><li><a name="__END__"></a>    __END__</li><li><a name="bloop"></a>    sub <span class="m">bloop</span> <span class="s">{</span></li><li>        <a class="l_k" href="functions/print.html">print</a> <a class="l_k" href="functions/join.html">join</a> <span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="w">No</span><span class="cm">,</span> <span class="w">strict</span><span class="cm">,</span> <span class="w">here</span><span class="s">)</span><span class="cm">,</span> <span class="q">&quot;!\n&quot;</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><p>then <code class="inline"><a class="l_k" href="functions/use.html">use</a> <span class="w">strict</span><span class="sc">;</span></code>
 isn't in force within the autoloaded subroutines. It would
be more consistent (and less surprising) to arrange for all lexical pragmas
in force at the __END__ block to be in force within each autoloaded subroutine.</p>
<p>There's a similar problem with SelfLoader.</p>
<a class='view-head2' id="profile-installman"></a><h3 class='h3' >profile installman</h3>
<p>The <i>installman</i> script is slow. All it is doing text processing, which we're
told is something Perl is good at. So it would be nice to know what it is doing
that is taking so much CPU, and where possible address it.</p>
<a class='view-head1' id="Tasks-that-need-a-little-sysadmin-type-knowledge"></a><h2 class='h2' >Tasks that need a little sysadmin-type knowledge</h2>
<p>Or if you prefer, tasks that you would learn from, and broaden your skills
base...</p>
<a class='view-head2' id="make-HTML-install-work"></a><h3 class='h3' >make HTML install work</h3>
<p>There is an <code class="inline"><span class="w">installhtml</span></code>
 target in the Makefile. It's marked as
"experimental". It would be good to get this tested, make it work reliably, and
remove the "experimental" tag. This would include</p>
<dl>
<li>
<p>Checking that cross linking between various parts of the documentation works.
In particular that links work between the modules (files with POD in <i>lib/</i>)
and the core documentation (files in <i>pod/</i>)</p>
</li>
<li>
<p>Work out how to split <code class="inline"><span class="w">perlfunc</span></code>
 into chunks, preferably one per function
group, preferably with general case code that could be used elsewhere.
Challenges here are correctly identifying the groups of functions that go
together, and making the right named external cross-links point to the right
page. Things to be aware of are <code class="inline"><a class="l_k" href="functions/-X.html">-X</a></code>, groups such as <code class="inline"><a class="l_k" href="functions/getpwnam.html">getpwnam</a></code> to
<code class="inline"><a class="l_k" href="functions/endservent.html">endservent</a></code>, two or more <code class="inline"><span class="pd">=items</span></code>
 giving the different parameter lists, such
as</p>
<pre class="verbatim"><ol><li>    =<span class="w">item</span> <a class="l_k" href="functions/substr.html">substr</a> <span class="w">EXPR</span><span class="cm">,</span><span class="w">OFFSET</span><span class="cm">,</span><span class="w">LENGTH</span><span class="cm">,</span><span class="w">REPLACEMENT</span></li><li>    =<span class="w">item</span> <a class="l_k" href="functions/substr.html">substr</a> <span class="w">EXPR</span><span class="cm">,</span><span class="w">OFFSET</span><span class="cm">,</span><span class="w">LENGTH</span></li><li>    =<span class="w">item</span> <a class="l_k" href="functions/substr.html">substr</a> <span class="w">EXPR</span><span class="cm">,</span><span class="w">OFFSET</span></li></ol></pre><p>and different parameter lists having different meanings. (eg <code class="inline"><a class="l_k" href="functions/select.html">select</a></code>)</p>
</li>
</dl>
<a class='view-head2' id="compressed-man-pages"></a><h3 class='h3' >compressed man pages</h3>
<p>Be able to install them. This would probably need a configure test to see how
the system does compressed man pages (same directory/different directory?
same filename/different filename), as well as tweaking the <i>installman</i> script
to compress as necessary.</p>
<a class='view-head2' id="Add-a-code-coverage-target-to-the-Makefile"></a><h3 class='h3' >Add a code coverage target to the Makefile</h3>
<p>Make it easy for anyone to run Devel::Cover on the core's tests. The steps
to do this manually are roughly</p>
<ul>
<li>
<p>do a normal <code class="inline"><span class="w">Configure</span></code>
, but include Devel::Cover as a module to install
(see <i>INSTALL</i> for how to do this)</p>
</li>
<li>
<pre class="verbatim"><ol><li>    <span class="w">make</span> <span class="w">perl</span></li></ol></pre></li>
<li>
<pre class="verbatim"><ol><li>    <span class="w">cd</span> <span class="w">t</span><span class="sc">;</span> <span class="w">HARNESS_PERL_SWITCHES</span>=-<span class="w">MDevel::Cover</span> .<span class="q">/perl -I../</span><span class="w">lib</span> <span class="w">harness</span></li></ol></pre></li>
<li>
<p>Process the resulting Devel::Cover database</p>
</li>
</ul>
<p>This just give you the coverage of the <i>.pm</i>s. To also get the C level
coverage you need to</p>
<ul>
<li>
<p>Additionally tell <code class="inline"><span class="w">Configure</span></code>
 to use the appropriate C compiler flags for
<code class="inline"><span class="w">gcov</span></code>
</p>
</li>
<li>
<pre class="verbatim"><ol><li>    <span class="w">make</span> <span class="w">perl</span>.<span class="w">gcov</span></li></ol></pre><p>(instead of <code class="inline"><span class="w">make</span> <span class="w">perl</span></code>
)</p>
</li>
<li>
<p>After running the tests run <code class="inline"><span class="w">gcov</span></code>
 to generate all the <i>.gcov</i> files.
(Including down in the subdirectories of <i>ext/</i></p>
</li>
<li>
<p>(From the top level perl directory) run <code class="inline"><span class="w">gcov2perl</span></code>
 on all the <code class="inline">.<span class="w">gcov</span></code>
 files
to get their stats into the cover_db directory.</p>
</li>
<li>
<p>Then process the Devel::Cover database</p>
</li>
</ul>
<p>It would be good to add a single switch to <code class="inline"><span class="w">Configure</span></code>
 to specify that you
wanted to perform perl level coverage, and another to specify C level
coverage, and have <code class="inline"><span class="w">Configure</span></code>
 and the <i>Makefile</i> do all the right things
automatically.</p>
<a class='view-head2' id="Make-Config.pm-cope-with-differences-between-built-and-installed-perl"></a><h3 class='h3' >Make Config.pm cope with differences between built and installed perl</h3>
<p>Quite often vendors ship a perl binary compiled with their (pay-for)
compilers.  People install a free compiler, such as gcc. To work out how to
build extensions, Perl interrogates <code class="inline"><span class="i">%Config</span></code>
, so in this situation
<code class="inline"><span class="i">%Config</span></code>
 describes compilers that aren't there, and extension building
fails. This forces people into choosing between re-compiling perl themselves
using the compiler they have, or only using modules that the vendor ships.</p>
<p>It would be good to find a way teach <code class="inline"><span class="w">Config</span>.<span class="w">pm</span></code>
 about the installation setup,
possibly involving probing at install time or later, so that the <code class="inline"><span class="i">%Config</span></code>
 in
a binary distribution better describes the installed machine, when the
installed machine differs from the build machine in some significant way.</p>
<a class='view-head2' id="linker-specification-files"></a><h3 class='h3' >linker specification files</h3>
<p>Some platforms mandate that you provide a list of a shared library's external
symbols to the linker, so the core already has the infrastructure in place to
do this for generating shared perl libraries. My understanding is that the
GNU toolchain can accept an optional linker specification file, and restrict
visibility just to symbols declared in that file. It would be good to extend
<i>makedef.pl</i> to support this format, and to provide a means within
<code class="inline"><span class="w">Configure</span></code>
 to enable it. This would allow Unix users to test that the
export list is correct, and to build a perl that does not pollute the global
namespace with private symbols.</p>
<a class='view-head2' id="Cross-compile-support"></a><h3 class='h3' >Cross-compile support</h3>
<p>Currently <code class="inline"><span class="w">Configure</span></code>
 understands <code class="inline">-<span class="w">Dusecrosscompile</span></code>
 option. This option
arranges for building <code class="inline"><span class="w">miniperl</span></code>
 for TARGET machine, so this <code class="inline"><span class="w">miniperl</span></code>
 is
assumed then to be copied to TARGET machine and used as a replacement of full
<code class="inline"><span class="w">perl</span></code>
 executable.</p>
<p>This could be done little differently. Namely <code class="inline"><span class="w">miniperl</span></code>
 should be built for
HOST and then full <code class="inline"><span class="w">perl</span></code>
 with extensions should be compiled for TARGET.
This, however, might require extra trickery for %Config: we have one config
first for HOST and then another for TARGET.  Tools like MakeMaker will be
mightily confused.  Having around two different types of executables and
libraries (HOST and TARGET) makes life interesting for Makefiles and
shell (and Perl) scripts.  There is $Config{run}, normally empty, which
can be used as an execution wrapper.  Also note that in some
cross-compilation/execution environments the HOST and the TARGET do
not see the same filesystem(s), the $Config{run} may need to do some
file/directory copying back and forth.</p>
<a class='view-head2' id="roffitall"></a><h3 class='h3' >roffitall</h3>
<p>Make <i>pod/roffitall</i> be updated by <i>pod/buildtoc</i>.</p>
<a class='view-head2' id="Split-%22linker%22-from-%22compiler%22"></a><h3 class='h3' >Split "linker" from "compiler"</h3>
<p>Right now, Configure probes for two commands, and sets two variables:</p>
<ul>
<li><a class='view-title' id="*-cc-(in-_cc.U_)"></a><strong><code class="inline"><span class="w">cc</span></code>
 (in <i>cc.U</i>)</strong>
<p>This variable holds the name of a command to execute a C compiler which
can resolve multiple global references that happen to have the same
name.  Usual values are <i>cc</i> and <i>gcc</i>.
Fervent ANSI compilers may be called <i>c89</i>.  AIX has <i>xlc</i>.</p>
</li>
<li><a class='view-title' id="*-ld-(in-_dlsrc.U_)"></a><strong><code class="inline"><span class="w">ld</span></code>
 (in <i>dlsrc.U</i>)</strong>
<p>This variable indicates the program to be used to link
libraries for dynamic loading.  On some systems, it is <i>ld</i>.
On ELF systems, it should be <code class="inline"><span class="i">$cc</span></code>
.  Mostly, we'll try to respect
the hint file setting.</p>
</li>
</ul>
<p>There is an implicit historical assumption from around Perl5.000alpha
something, that <code class="inline"><span class="i">$cc</span></code>
 is also the correct command for linking object files
together to make an executable. This may be true on Unix, but it's not true
on other platforms, and there are a maze of work arounds in other places (such
as <i>Makefile.SH</i>) to cope with this.</p>
<p>Ideally, we should create a new variable to hold the name of the executable
linker program, probe for it in <i>Configure</i>, and centralise all the special
case logic there or in hints files.</p>
<p>A small bikeshed issue remains - what to call it, given that <code class="inline"><span class="i">$ld</span></code>
 is already
taken (arguably for the wrong thing now, but on SunOS 4.1 it is the command
for creating dynamically-loadable modules) and <code class="inline"><span class="i">$link</span></code>
 could be confused with
the Unix command line executable of the same name, which does something
completely different. Andy Dougherty makes the counter argument "In parrot, I
tried to call the command used to link object files and  libraries into an
executable <i>link</i>, since that's what my vaguely-remembered DOS and VMS
experience suggested. I don't think any real confusion has ensued, so it's
probably a reasonable name for perl5 to use."</p>
<p>"Alas, I've always worried that introducing it would make things worse, 
since now the module building utilities would have to look for 
<code class="inline"><span class="i">$Config</span>{<span class="w">link</span>}</code>
 and institute a fall-back plan if it weren't found."
Although I can see that as confusing, given that <code class="inline"><span class="i">$Config</span>{<span class="w">d_link</span>}</code>
 is true
when (hard) links are available.</p>
<a class='view-head1' id="Tasks-that-need-a-little-C-knowledge"></a><h2 class='h2' >Tasks that need a little C knowledge</h2>
<p>These tasks would need a little C knowledge, but don't need any specific
background or experience with XS, or how the Perl interpreter works</p>
<a class='view-head2' id="Weed-out-needless-PERL_UNUSED_ARG"></a><h3 class='h3' >Weed out needless PERL_UNUSED_ARG</h3>
<p>The C code uses the macro <code class="inline"><span class="w">PERL_UNUSED_ARG</span></code>
 to stop compilers warning about
unused arguments. Often the arguments can't be removed, as there is an
external constraint that determines the prototype of the function, so this
approach is valid. However, there are some cases where <code class="inline"><span class="w">PERL_UNUSED_ARG</span></code>

could be removed. Specifically</p>
<ul>
<li>
<p>The prototypes of (nearly all) static functions can be changed</p>
</li>
<li>
<p>Unused arguments generated by short cut macros are wasteful - the short cut
macro used can be changed.</p>
</li>
</ul>
<a class='view-head2' id="Modernize-the-order-of-directories-in-%40INC"></a><h3 class='h3' >Modernize the order of directories in @INC</h3>
<p>The way @INC is laid out by default, one cannot upgrade core (dual-life)
modules without overwriting files. This causes problems for binary
package builders.  One possible proposal is laid out in this
message:
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2002-04/msg02380.html">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2002-04/msg02380.html</a>.</p>
<a class='view-head2' id="-Duse32bit*"></a><h3 class='h3' >-Duse32bit*</h3>
<p>Natively 64-bit systems need neither -Duse64bitint nor -Duse64bitall.
On these systems, it might be the default compilation mode, and there
is currently no guarantee that passing no use64bitall option to the
Configure process will build a 32bit perl. Implementing -Duse32bit*
options would be nice for perl 5.12.</p>
<a class='view-head2' id="Make-it-clear-from--v-if-this-is-the-exact-official-release"></a><h3 class='h3' >Make it clear from -v if this is the exact official release</h3>
<p>Currently perl from <code class="inline"><span class="w">p4</span></code>
/<code class="inline"><span class="w">rsync</span></code>
 ships with a <i>patchlevel.h</i> file that
usually defines one local patch, of the form "MAINT12345" or "RC1". The output
of perl -v doesn't report that a perl isn't an official release, and this
information can get lost in bugs reports. Because of this, the minor version
isn't bumped up until RC time, to minimise the possibility of versions of perl
escaping that believe themselves to be newer than they actually are.</p>
<p>It would be useful to find an elegant way to have the "this is an interim
maintenance release" or "this is a release candidate" in the terse -v output,
and have it so that it's easy for the pumpking to remove this just as the
release tarball is rolled up. This way the version pulled out of rsync would
always say "I'm a development release" and it would be safe to bump the
reported minor version as soon as a release ships, which would aid perl
developers.</p>
<p>This task is really about thinking of an elegant way to arrange the C source
such that it's trivial for the Pumpking to flag "this is an official release"
when making a tarball, yet leave the default source saying "I'm not the
official release".</p>
<a class='view-head2' id="Profile-Perl---am-I-hot-or-not%3f"></a><h3 class='h3' >Profile Perl - am I hot or not?</h3>
<p>The Perl source code is stable enough that it makes sense to profile it,
identify and optimise the hotspots. It would be good to measure the
performance of the Perl interpreter using free tools such as cachegrind,
gprof, and dtrace, and work to reduce the bottlenecks they reveal.</p>
<p>As part of this, the idea of <i>pp_hot.c</i> is that it contains the <i>hot</i> ops,
the ops that are most commonly used. The idea is that by grouping them, their
object code will be adjacent in the executable, so they have a greater chance
of already being in the CPU cache (or swapped in) due to being near another op
already in use.</p>
<p>Except that it's not clear if these really are the most commonly used ops. So
as part of exercising your skills with coverage and profiling tools you might
want to determine what ops <i>really</i> are the most commonly used. And in turn
suggest evictions and promotions to achieve a better <i>pp_hot.c</i>.</p>
<p>One piece of Perl code that might make a good testbed is <i>installman</i>.</p>
<a class='view-head2' id="Allocate-OPs-from-arenas"></a><h3 class='h3' >Allocate OPs from arenas</h3>
<p>Currently all new OP structures are individually malloc()ed and free()d.
All <code class="inline"><span class="w">malloc</span></code>
 implementations have space overheads, and are now as fast as
custom allocates so it would both use less memory and less CPU to allocate
the various OP structures from arenas. The SV arena code can probably be
re-used for this.</p>
<p>Note that Configuring perl with <code class="inline">-<span class="w">Accflags</span>=-<span class="w">DPL_OP_SLAB_ALLOC</span></code>
 will use
Perl_Slab_alloc() to pack optrees into a contiguous block, which is
probably superior to the use of OP arenas, esp. from a cache locality
standpoint.  See <a href="#Profile-Perl---am-I-hot-or-not%3f">Profile Perl - am I hot or not?</a>.</p>
<a class='view-head2' id="Improve-win32%2fwince.c"></a><h3 class='h3' >Improve win32/wince.c</h3>
<p>Currently, numerous functions look virtually, if not completely,
identical in both <code class="inline"><span class="w">win32</span>/<span class="w">wince</span>.<span class="w">c</span></code>
 and <code class="inline"><span class="w">win32</span>/<span class="w">win32</span>.<span class="w">c</span></code>
 files, which can't
be good.</p>
<a class='view-head2' id="Use-secure-CRT-functions-when-building-with-VC8-on-Win32"></a><h3 class='h3' >Use secure CRT functions when building with VC8 on Win32</h3>
<p>Visual C++ 2005 (VC++ 8.x) deprecated a number of CRT functions on the basis
that they were "unsafe" and introduced differently named secure versions of
them as replacements, e.g. instead of writing</p>
<pre class="verbatim"><ol><li>    <span class="w">FILE</span>* <span class="w">f</span> = <span class="i">fopen</span><span class="s">(</span><span class="w">__FILE__</span><span class="cm">,</span> <span class="q">&quot;r&quot;</span><span class="s">)</span><span class="sc">;</span></li></ol></pre><p>one should now write</p>
<pre class="verbatim"><ol><li>    <span class="w">FILE</span>* <span class="w">f</span><span class="sc">;</span></li><li>    <span class="w">errno_t</span> err = <span class="i">fopen_s</span><span class="s">(</span><span class="i">&amp;f</span><span class="cm">,</span> <span class="w">__FILE__</span><span class="cm">,</span> <span class="q">&quot;r&quot;</span><span class="s">)</span><span class="sc">;</span></li></ol></pre><p>Currently, the warnings about these deprecations have been disabled by adding
-D_CRT_SECURE_NO_DEPRECATE to the CFLAGS. It would be nice to remove that
warning suppressant and actually make use of the new secure CRT functions.</p>
<p>There is also a similar issue with POSIX CRT function names like fileno having
been deprecated in favour of ISO C++ conformant names like _fileno. These
warnings are also currently suppressed by adding -D_CRT_NONSTDC_NO_DEPRECATE. It
might be nice to do as Microsoft suggest here too, although, unlike the secure
functions issue, there is presumably little or no benefit in this case.</p>
<a class='view-head2' id="Fix-POSIX%3a%3aaccess()-and-chdir()-on-Win32"></a><h3 class='h3' >Fix POSIX::access() and chdir() on Win32</h3>
<p>These functions currently take no account of DACLs and therefore do not behave
correctly in situations where access is restricted by DACLs (as opposed to the
read-only attribute).</p>
<p>Furthermore, POSIX::access() behaves differently for directories having the
read-only attribute set depending on what CRT library is being used. For
example, the _access() function in the VC6 and VC7 CRTs (wrongly) claim that
such directories are not writable, whereas in fact all directories are writable
unless access is denied by DACLs. (In the case of directories, the read-only
attribute actually only means that the directory cannot be deleted.) This CRT
bug is fixed in the VC8 and VC9 CRTs (but, of course, the directory may still
not actually be writable if access is indeed denied by DACLs).</p>
<p>For the chdir() issue, see ActiveState bug #74552:
<a href="http://bugs.activestate.com/show_bug.cgi?id=74552">http://bugs.activestate.com/show_bug.cgi?id=74552</a></p>
<p>Therefore, DACLs should be checked both for consistency across CRTs and for
the correct answer.</p>
<p>(Note that perl's -w operator should not be modified to check DACLs. It has
been written so that it reflects the state of the read-only attribute, even
for directories (whatever CRT is being used), for symmetry with chmod().)</p>
<a class='view-head2' id="strcat()%2c-strcpy()%2c-strncat()%2c-strncpy()%2c-sprintf()%2c-vsprintf()"></a><h3 class='h3' >strcat(), strcpy(), strncat(), strncpy(), sprintf(), vsprintf()</h3>
<p>Maybe create a utility that checks after each libperl.a creation that
none of the above (nor sprintf(), vsprintf(), or *SHUDDER* gets())
ever creep back to libperl.a.</p>
<pre class="verbatim"><ol><li>  <span class="w">nm</span> <span class="w">libperl</span>.<span class="w">a</span> | .<span class="q">/miniperl -alne &#39;$o = $F[0] if /</span><span class="co">:</span><span class="i">$/</span><span class="sc">;</span> <a class="l_k" href="functions/print.html">print</a> <span class="q">&quot;$o $F[1]&quot;</span> if <span class="i">$F</span>[<span class="n">0</span>] eq <span class="q">&quot;U&quot;</span> &amp;&amp; <span class="i">$F</span>[<span class="n">1</span>] =~ <span class="q">/^(?:strn?c(?:at|py)|v?sprintf|gets)$/</span><span class="q">&#39;</span></li></ol></pre><p>Note, of course, that this will only tell whether <strong>your</strong> platform
is using those naughty interfaces.</p>
<a class='view-head2' id="-D_FORTIFY_SOURCE%3d2%2c--fstack-protector"></a><h3 class='h3' >-D_FORTIFY_SOURCE=2, -fstack-protector</h3>
<p>Recent glibcs support <code class="inline">-<span class="w">D_FORTIFY_SOURCE</span>=<span class="n">2</span></code>
 and recent gcc
(4.1 onwards?) supports <code class="inline">-<span class="w">fstack</span>-<span class="w">protector</span></code>
, both of which give
protection against various kinds of buffer overflow problems.
These should probably be used for compiling Perl whenever available,
Configure and/or hints files should be adjusted to probe for the
availability of these features and enable them as appropriate.</p>
<a class='view-head2' id="Arenas-for-GPs%3f-For-MAGIC%3f"></a><h3 class='h3' >Arenas for GPs? For MAGIC?</h3>
<p><code class="inline"><span class="w">struct</span> <span class="w">gp</span></code>
 and <code class="inline"><span class="w">struct</span> <span class="w">magic</span></code>
 are both currently allocated by <code class="inline"><span class="w">malloc</span></code>
.
It might be a speed or memory saving to change to using arenas. Or it might
not. It would need some suitable benchmarking first. In particular, <code class="inline"><span class="w">GP</span></code>
s
can probably be changed with minimal compatibility impact (probably nothing
outside of the core, or even outside of <i>gv.c</i> allocates them), but they
probably aren't allocated/deallocated often enough for a speed saving. Whereas
<code class="inline"><span class="w">MAGIC</span></code>
 is allocated/deallocated more often, but in turn, is also something
more externally visible, so changing the rules here may bite external code.</p>
<a class='view-head2' id="Shared-arenas"></a><h3 class='h3' >Shared arenas</h3>
<p>Several SV body structs are now the same size, notably PVMG and PVGV, PVAV and
PVHV, and PVCV and PVFM. It should be possible to allocate and return same
sized bodies from the same actual arena, rather than maintaining one arena for
each. This could save 4-6K per thread, of memory no longer tied up in the
not-yet-allocated part of an arena.</p>
<a class='view-head1' id="Tasks-that-need-a-knowledge-of-XS"></a><h2 class='h2' >Tasks that need a knowledge of XS</h2>
<p>These tasks would need C knowledge, and roughly the level of knowledge of
the perl API that comes from writing modules that use XS to interface to
C.</p>
<a class='view-head2' id="investigate-removing-int_macro_int-from-POSIX.xs"></a><h3 class='h3' >investigate removing int_macro_int from POSIX.xs</h3>
<p>As a hang over from the original <code class="inline"><span class="w">constant</span></code>
 implementation, <i>POSIX.xs</i>
contains a function <code class="inline"><span class="w">int_macro_int</span></code>
 which in conjunction with <code class="inline">AUTOLOAD</code>
 is
used to wrap the C functions <code class="inline"><span class="w">WEXITSTATUS</span></code>
, <code class="inline"><span class="w">WIFEXITED</span></code>
, <code class="inline"><span class="w">WIFSIGNALED</span></code>
,
<code class="inline"><span class="w">WIFSTOPPED</span></code>
, <code class="inline"><span class="w">WSTOPSIG</span></code>
 and <code class="inline"><span class="w">WTERMSIG</span></code>
. It's probably worth replacing
this complexity with 5 simple direct wrappings of those 5 functions.</p>
<p>However, it would be interesting if someone could measure the memory usage
before and after, both for the case of <code class="inline"><a class="l_k" href="functions/use.html">use</a> <span class="i">POSIX</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span></code>
 and the case of
actually calling the Perl space functions.</p>
<a class='view-head2' id="safely-supporting-POSIX-SA_SIGINFO"></a><h3 class='h3' >safely supporting POSIX SA_SIGINFO</h3>
<p>Some years ago Jarkko supplied patches to provide support for the POSIX
SA_SIGINFO feature in Perl, passing the extra data to the Perl signal handler.</p>
<p>Unfortunately, it only works with "unsafe" signals, because under safe
signals, by the time Perl gets to run the signal handler, the extra
information has been lost. Moreover, it's not easy to store it somewhere,
as you can't call mutexs, or do anything else fancy, from inside a signal
handler.</p>
<p>So it strikes me that we could provide safe SA_SIGINFO support</p>
<dl>
<li>
<p>Provide global variables for two file descriptors</p>
</li>
<li>
<p>When the first request is made via <code class="inline"><span class="w">sigaction</span></code>
 for <code class="inline"><span class="w">SA_SIGINFO</span></code>
, create a
pipe, store the reader in one, the writer in the other</p>
</li>
<li>
<p>In the "safe" signal handler (<code class="inline"><span class="i">Perl_csighandler</span><span class="s">(</span><span class="s">)</span></code>
/<code class="inline"><span class="i">S_raise_signal</span><span class="s">(</span><span class="s">)</span></code>
), if
the <code class="inline"><span class="w">siginfo_t</span></code>
 pointer non-<code class="inline"><span class="w">NULL</span></code>
, and the writer file handle is open,</p>
<dl>
<li>
<p>serialise signal number, <code class="inline"><span class="w">struct</span> <span class="w">siginfo_t</span></code>
 (or at least the parts we care
about) into a small auto char buff</p>
</li>
<li>
<p><code class="inline"><a class="l_k" href="functions/write.html">write()</a></code> that (non-blocking) to the writer fd</p>
<dl>
<li>
<p>if it writes 100%, flag the signal in a counter of "signals on the pipe" akin
to the current per-signal-number counts</p>
</li>
<li>
<p>if it writes 0%, assume the pipe is full. Flag the data as lost?</p>
</li>
<li>
<p>if it writes partially, croak a panic, as your OS is broken.</p>
</li>
</dl>
</li>
</dl>
</li>
<li>
<p>in the regular <code class="inline"><span class="i">PERL_ASYNC_CHECK</span><span class="s">(</span><span class="s">)</span></code>
 processing, if there are "signals on
the pipe", read the data out, deserialise, build the Perl structures on
the stack (code in <code class="inline"><span class="i">Perl_sighandler</span><span class="s">(</span><span class="s">)</span></code>
, the "unsafe" handler), and call as
usual.</p>
</li>
</dl>
<p>I think that this gets us decent <code class="inline"><span class="w">SA_SIGINFO</span></code>
 support, without the current risk
of running Perl code inside the signal handler context. (With all the dangers
of things like <code class="inline"><span class="w">malloc</span></code>
 corruption that that currently offers us)</p>
<p>For more information see the thread starting with this message:
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2008-03/msg00305.html">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2008-03/msg00305.html</a></p>
<a class='view-head2' id="autovivification"></a><h3 class='h3' >autovivification</h3>
<p>Make all autovivification consistent w.r.t LVALUE/RVALUE and strict/no strict;</p>
<p>This task is incremental - even a little bit of work on it will help.</p>
<a class='view-head2' id="Unicode-in-Filenames"></a><h3 class='h3' >Unicode in Filenames</h3>
<p>chdir, chmod, chown, chroot, exec, glob, link, lstat, mkdir, open,
opendir, qx, readdir, readlink, rename, rmdir, stat, symlink, sysopen,
system, truncate, unlink, utime, -X.  All these could potentially accept
Unicode filenames either as input or output (and in the case of system
and qx Unicode in general, as input or output to/from the shell).
Whether a filesystem - an operating system pair understands Unicode in
filenames varies.</p>
<p>Known combinations that have some level of understanding include
Microsoft NTFS, Apple HFS+ (In Mac OS 9 and X) and Apple UFS (in Mac
OS X), NFS v4 is rumored to be Unicode, and of course Plan 9.  How to
create Unicode filenames, what forms of Unicode are accepted and used
(UCS-2, UTF-16, UTF-8), what (if any) is the normalization form used,
and so on, varies.  Finding the right level of interfacing to Perl
requires some thought.  Remember that an OS does not implicate a
filesystem.</p>
<p>(The Windows -C command flag "wide API support" has been at least
temporarily retired in 5.8.1, and the -C has been repurposed, see
<a href="perlrun.html">perlrun</a>.)</p>
<p>Most probably the right way to do this would be this:
<a href="#Virtualize-operating-system-access">Virtualize operating system access</a>.</p>
<a class='view-head2' id="Unicode-in-%25ENV"></a><h3 class='h3' >Unicode in %ENV</h3>
<p>Currently the %ENV entries are always byte strings.
See <a href="#Virtualize-operating-system-access">Virtualize operating system access</a>.</p>
<a class='view-head2' id="Unicode-and-glob()"></a><h3 class='h3' >Unicode and glob()</h3>
<p>Currently glob patterns and filenames returned from File::Glob::glob()
are always byte strings.  See <a href="#Virtualize-operating-system-access">Virtualize operating system access</a>.</p>
<a class='view-head2' id="Unicode-and-lc%2fuc-operators"></a><h3 class='h3' >Unicode and lc/uc operators</h3>
<p>Some built-in operators (<code class="inline"><a class="l_k" href="functions/lc.html">lc</a></code>, <code class="inline"><a class="l_k" href="functions/uc.html">uc</a></code>, etc.) behave differently, based on
what the internal encoding of their argument is. That should not be the
case. Maybe add a pragma to switch behaviour.</p>
<a class='view-head2' id="use-less-'memory'"></a><h3 class='h3' >use less 'memory'</h3>
<p>Investigate trade offs to switch out perl's choices on memory usage.
Particularly perl should be able to give memory back.</p>
<p>This task is incremental - even a little bit of work on it will help.</p>
<a class='view-head2' id="Re-implement-%3aunique-in-a-way-that-is-actually-thread-safe"></a><h3 class='h3' >Re-implement <code class="inline"><span class="j">:</span><span class="w">unique</span></code>
 in a way that is actually thread-safe</h3>
<p>The old implementation made bad assumptions on several levels. A good 90%
solution might be just to make <code class="inline"><span class="j">:</span><span class="w">unique</span></code>
 work to share the string buffer
of SvPVs. That way large constant strings can be shared between ithreads,
such as the configuration information in <i>Config</i>.</p>
<a class='view-head2' id="Make-tainting-consistent"></a><h3 class='h3' >Make tainting consistent</h3>
<p>Tainting would be easier to use if it didn't take documented shortcuts and
allow taint to "leak" everywhere within an expression.</p>
<a class='view-head2' id="readpipe(LIST)"></a><h3 class='h3' >readpipe(LIST)</h3>
<p>system() accepts a LIST syntax (and a PROGRAM LIST syntax) to avoid
running a shell. readpipe() (the function behind qx//) could be similarly
extended.</p>
<a class='view-head2' id="Audit-the-code-for-destruction-ordering-assumptions"></a><h3 class='h3' >Audit the code for destruction ordering assumptions</h3>
<p>Change 25773 notes</p>
<pre class="verbatim"><ol><li>    <span class="q">/* Need to check SvMAGICAL, as during global destruction it may be that</span></li><li>       <span class="q">       AvARYLEN(av) has been freed before av, and hence the SvANY() pointer</span></li><li>       <span class="q">       is now part of the linked list of SV heads, rather than pointing to</span></li><li>       <span class="q">       the original body.  */</span></li><li>    /<span class="i">* FIXME</span> - <span class="w">audit</span> <span class="w">the</span> <span class="w">code</span> for <span class="w">other</span> <span class="w">bugs</span> <span class="w">like</span> <span class="w">this</span> <span class="w">one</span>.  <span class="i">*/</span></li></ol></pre><p>adding the <code class="inline"><span class="w">SvMAGICAL</span></code>
 check to</p>
<pre class="verbatim"><ol><li>    if <span class="s">(</span><span class="i">AvARYLEN</span><span class="s">(</span><span class="w">av</span><span class="s">)</span> &amp;&amp; <span class="i">SvMAGICAL</span><span class="s">(</span><span class="i">AvARYLEN</span><span class="s">(</span><span class="w">av</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span></li><li>        <span class="w">MAGIC</span> *<span class="w">mg</span> = <span class="w">mg_find</span> <span class="s">(</span><span class="i">AvARYLEN</span><span class="s">(</span><span class="w">av</span><span class="s">)</span><span class="cm">,</span> <span class="w">PERL_MAGIC_arylen</span><span class="s">)</span><span class="sc">;</span></li></ol></pre><p>Go through the core and look for similar assumptions that SVs have particular
types, as all bets are off during global destruction.</p>
<a class='view-head2' id="Extend-PerlIO-and-PerlIO%3a%3aScalar"></a><h3 class='h3' >Extend PerlIO and PerlIO::Scalar</h3>
<p>PerlIO::Scalar doesn't know how to truncate().  Implementing this
would require extending the PerlIO vtable.</p>
<p>Similarly the PerlIO vtable doesn't know about formats (write()), or
about stat(), or chmod()/chown(), utime(), or flock().</p>
<p>(For PerlIO::Scalar it's hard to see what e.g. mode bits or ownership
would mean.)</p>
<p>PerlIO doesn't do directories or symlinks, either: mkdir(), rmdir(),
opendir(), closedir(), seekdir(), rewinddir(), glob(); symlink(),
readlink().</p>
<p>See also <a href="#Virtualize-operating-system-access">Virtualize operating system access</a>.</p>
<a class='view-head2' id="-C-on-the-%23!-line"></a><h3 class='h3' >-C on the #! line</h3>
<p>It should be possible to make -C work correctly if found on the #! line,
given that all perl command line options are strict ASCII, and -C changes
only the interpretation of non-ASCII characters, and not for the script file
handle. To make it work needs some investigation of the ordering of function
calls during startup, and (by implication) a bit of tweaking of that order.</p>
<a class='view-head2' id="Propagate-const-outwards-from-Perl_moreswitches()"></a><h3 class='h3' >Propagate const outwards from Perl_moreswitches()</h3>
<p>Change 32057 changed the parameter and return value of <code class="inline"><span class="i">Perl_moreswitches</span><span class="s">(</span><span class="s">)</span></code>

from &lt;char *&gt; to &lt;const char *&gt;. It should now be possible to propagate
const-correctness outwards to <code class="inline"><span class="i">S_parse_body</span><span class="s">(</span><span class="s">)</span></code>
, <code class="inline"><span class="i">Perl_moreswitches</span><span class="s">(</span><span class="s">)</span></code>

and <code class="inline"><span class="i">Perl_yylex</span><span class="s">(</span><span class="s">)</span></code>
.</p>
<a class='view-head2' id="Duplicate-logic-in-S_method_common()-and-Perl_gv_fetchmethod_autoload()"></a><h3 class='h3' >Duplicate logic in S_method_common() and Perl_gv_fetchmethod_autoload()</h3>
<p>A comment in <code class="inline"><span class="w">S_method_common</span></code>
 notes</p>
<pre class="verbatim"><ol><li>	<span class="q">/* This code tries to figure out just what went wrong with</span></li><li>	   <span class="q">	   gv_fetchmethod.  It therefore needs to duplicate a lot of</span></li><li>	   <span class="q">	   the internals of that function.  We can&#39;t move it inside</span></li><li>	   <span class="q">	   Perl_gv_fetchmethod_autoload(), however, since that would</span></li><li>	   <span class="q">	   cause UNIVERSAL-&gt;can(&quot;NoSuchPackage::foo&quot;) to croak, and we</span></li><li>	   <span class="q">	   don&#39;t want that.</span></li><li>	<span class="q">	*/</span></li></ol></pre><p>If <code class="inline"><span class="w">Perl_gv_fetchmethod_autoload</span></code>
 gets rewritten to take (more) flag bits,
then it ought to be possible to move the logic from <code class="inline"><span class="w">S_method_common</span></code>
 to
the "right" place. When making this change it would probably be good to also
pass in at least the method name length, if not also pre-computed hash values
when known. (I'm contemplating a plan to pre-compute hash values for common
fixed strings such as <code class="inline"><span class="w">ISA</span></code>
 and pass them in to functions.)</p>
<a class='view-head2' id="Organize-error-messages"></a><h3 class='h3' >Organize error messages</h3>
<p>Perl's diagnostics (error messages, see <a href="perldiag.html">perldiag</a>) could use
reorganizing and formalizing so that each error message has its
stable-for-all-eternity unique id, categorized by severity, type, and
subsystem.  (The error messages would be listed in a datafile outside
of the Perl source code, and the source code would only refer to the
messages by the id.)  This clean-up and regularizing should apply
for all croak() messages.</p>
<p>This would enable all sorts of things: easier translation/localization
of the messages (though please do keep in mind the caveats of
<a href="Locale/Maketext.html">Locale::Maketext</a> about too straightforward approaches to
translation), filtering by severity, and instead of grepping for a
particular error message one could look for a stable error id.  (Of
course, changing the error messages by default would break all the
existing software depending on some particular error message...)</p>
<p>This kind of functionality is known as <i>message catalogs</i>.  Look for
inspiration for example in the catgets() system, possibly even use it
if available-- but <strong>only</strong> if available, all platforms will <strong>not</strong>
have catgets().</p>
<p>For the really pure at heart, consider extending this item to cover
also the warning messages (see <a href="perllexwarn.html">perllexwarn</a>, <code class="inline"><span class="w">warnings</span>.<span class="w">pl</span></code>
).</p>
<a class='view-head1' id="Tasks-that-need-a-knowledge-of-the-interpreter"></a><h2 class='h2' >Tasks that need a knowledge of the interpreter</h2>
<p>These tasks would need C knowledge, and knowledge of how the interpreter works,
or a willingness to learn.</p>
<a class='view-head2' id="error-reporting-of-%5b%24a-%3b-%24b%5d"></a><h3 class='h3' >error reporting of [$a ; $b]</h3>
<p>Using <code class="inline"><span class="sc">;</span></code>
 inside brackets is a syntax error, and we don't propose to change
that by giving it any meaning. However, it's not reported very helpfully:</p>
<pre class="verbatim"><ol><li>    <span class="i">$ perl</span> -<span class="w">e</span> <span class="q">&#39;$a = [$b; $c];&#39;</span></li><li>    <span class="w">syntax</span> <span class="w">error</span> <span class="w">at</span> -e <span class="w">line</span> <span class="n">1</span><span class="cm">,</span> <span class="w">near</span> <span class="q">&quot;$b;&quot;</span></li><li>    <span class="w">syntax</span> <span class="w">error</span> <span class="w">at</span> -e <span class="w">line</span> <span class="n">1</span><span class="cm">,</span> <span class="w">near</span> <span class="q">&quot;$c]&quot;</span></li><li>    <span class="w">Execution</span> <span class="w">of</span> -e <span class="w">aborted</span> <span class="w">due</span> <span class="w">to</span> <span class="w">compilation</span> <span class="w">errors</span>.</li></ol></pre><p>It should be possible to hook into the tokeniser or the lexer, so that when a
<code class="inline"><span class="sc">;</span></code>
 is parsed where it is not legal as a statement terminator (ie inside
<code class="inline"><span class="s">{</span><span class="s">}</span></code>
 used as a hashref, <code class="inline"><span class="s">[</span><span class="s">]</span></code>
 or <code class="inline"><span class="s">(</span><span class="s">)</span></code>
) it issues an error something like
<i>';' isn't legal inside an expression - if you need multiple statements use a
do {...} block</i>. See the thread starting at
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2008-09/msg00573.html">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2008-09/msg00573.html</a></p>
<a class='view-head2' id="UTF-8-revamp"></a><h3 class='h3' >UTF-8 revamp</h3>
<p>The handling of Unicode is unclean in many places. For example, the regexp
engine matches in Unicode semantics whenever the string or the pattern is
flagged as UTF-8, but that should not be dependent on an internal storage
detail of the string. Likewise, case folding behaviour is dependent on the
UTF8 internal flag being on or off.</p>
<a class='view-head2' id="Properly-Unicode-safe-tokeniser-and-pads."></a><h3 class='h3' >Properly Unicode safe tokeniser and pads.</h3>
<p>The tokeniser isn't actually very UTF-8 clean. <code class="inline"><a class="l_k" href="functions/use.html">use</a> <span class="w">utf8</span><span class="sc">;</span></code>
 is a hack -
variable names are stored in stashes as raw bytes, without the utf-8 flag
set. The pad API only takes a <code class="inline"><span class="w">char</span> *</code>
 pointer, so that's all bytes too. The
tokeniser ignores the UTF-8-ness of <code class="inline"><span class="w">PL_rsfp</span></code>
, or any SVs returned from
source filters.  All this could be fixed.</p>
<a class='view-head2' id="state-variable-initialization-in-list-context"></a><h3 class='h3' >state variable initialization in list context</h3>
<p>Currently this is illegal:</p>
<pre class="verbatim"><ol><li>    <span class="w">state</span> <span class="s">(</span><span class="i">$a</span><span class="cm">,</span> <span class="i">$b</span><span class="s">)</span> = <span class="i">foo</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span></li></ol></pre><p>In Perl 6, <code class="inline"><span class="w">state</span> <span class="s">(</span><span class="i">$a</span><span class="s">)</span> = <span class="i">foo</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span></code>
 and <code class="inline"><span class="s">(</span><span class="w">state</span> <span class="i">$a</span><span class="s">)</span> = <span class="i">foo</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span></code>
 have different
semantics, which is tricky to implement in Perl 5 as currently they produce
the same opcode trees. The Perl 6 design is firm, so it would be good to
implement the necessary code in Perl 5. There are comments in
<code class="inline"><span class="i">Perl_newASSIGNOP</span><span class="s">(</span><span class="s">)</span></code>
 that show the code paths taken by various assignment
constructions involving state variables.</p>
<a class='view-head2' id="Implement-%24value-~~-0-..-%24range"></a><h3 class='h3' >Implement $value ~~ 0 .. $range</h3>
<p>It would be nice to extend the syntax of the <code class="inline">~~</code>
 operator to also
understand numeric (and maybe alphanumeric) ranges.</p>
<a class='view-head2' id="A-does()-built-in"></a><h3 class='h3' >A does() built-in</h3>
<p>Like ref(), only useful. It would call the <code class="inline"><span class="w">DOES</span></code>
 method on objects; it
would also tell whether something can be dereferenced as an
array/hash/etc., or used as a regexp, etc.
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2007-03/msg00481.html">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2007-03/msg00481.html</a></p>
<a class='view-head2' id="Tied-filehandles-and-write()-don't-mix"></a><h3 class='h3' >Tied filehandles and write() don't mix</h3>
<p>There is no method on tied filehandles to allow them to be called back by
formats.</p>
<a class='view-head2' id="Attach%2fdetach-debugger-from-running-program"></a><h3 class='h3' >Attach/detach debugger from running program</h3>
<p>The old perltodo notes "With <code class="inline"><span class="w">gdb</span></code>
, you can attach the debugger to a running
program if you pass the process ID. It would be good to do this with the Perl
debugger on a running Perl program, although I'm not sure how it would be
done." ssh and screen do this with named pipes in /tmp. Maybe we can too.</p>
<a class='view-head2' id="Optimize-away-empty-destructors"></a><h3 class='h3' >Optimize away empty destructors</h3>
<p>Defining an empty DESTROY method might be useful (notably in
AUTOLOAD-enabled classes), but it's still a bit expensive to call. That
could probably be optimized.</p>
<a class='view-head2' id="LVALUE-functions-for-lists"></a><h3 class='h3' >LVALUE functions for lists</h3>
<p>The old perltodo notes that lvalue functions don't work for list or hash
slices. This would be good to fix.</p>
<a class='view-head2' id="LVALUE-functions-in-the-debugger"></a><h3 class='h3' >LVALUE functions in the debugger</h3>
<p>The old perltodo notes that lvalue functions don't work in the debugger. This
would be good to fix.</p>
<a class='view-head2' id="regexp-optimiser-optional"></a><h3 class='h3' >regexp optimiser optional</h3>
<p>The regexp optimiser is not optional. It should configurable to be, to allow
its performance to be measured, and its bugs to be easily demonstrated.</p>
<a class='view-head2' id="delete-%26function"></a><h3 class='h3' >delete &amp;function</h3>
<p>Allow to delete functions. One can already undef them, but they're still
in the stash.</p>
<a class='view-head2' id="%2fw-regex-modifier"></a><h3 class='h3' ><code class="inline"><span class="q">/w</span></code>
 regex modifier</h3>
<p>That flag would enable to match whole words, and also to interpolate
arrays as alternations. With it, <code class="inline"><span class="q">/P/</span><span class="w">w</span></code>
 would be roughly equivalent to:</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/do.html">do</a> <span class="s">{</span> <a class="l_k" href="functions/local.html">local</a> <span class="i">$&quot;</span>=<span class="q">&#39;|&#39;</span><span class="sc">;</span> <span class="q">/\b(?:P)\b/</span> <span class="s">}</span></li></ol></pre><p>See <a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2007-01/msg00400.html">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2007-01/msg00400.html</a>
for the discussion.</p>
<a class='view-head2' id="optional-optimizer"></a><h3 class='h3' >optional optimizer</h3>
<p>Make the peephole optimizer optional. Currently it performs two tasks as
it walks the optree - genuine peephole optimisations, and necessary fixups of
ops. It would be good to find an efficient way to switch out the
optimisations whilst keeping the fixups.</p>
<a class='view-head2' id="You-WANT-*how*-many"></a><h3 class='h3' >You WANT *how* many</h3>
<p>Currently contexts are void, scalar and list. split has a special mechanism in
place to pass in the number of return values wanted. It would be useful to
have a general mechanism for this, backwards compatible and little speed hit.
This would allow proposals such as short circuiting sort to be implemented
as a module on CPAN.</p>
<a class='view-head2' id="lexical-aliases"></a><h3 class='h3' >lexical aliases</h3>
<p>Allow lexical aliases (maybe via the syntax <code class="inline"><a class="l_k" href="functions/my.html">my</a> \<span class="i">$alias</span> = \<span class="i">$foo</span></code>
.</p>
<a class='view-head2' id="entersub-XS-vs-Perl"></a><h3 class='h3' >entersub XS vs Perl</h3>
<p>At the moment pp_entersub is huge, and has code to deal with entering both
perl and XS subroutines. Subroutine implementations rarely change between 
perl and XS at run time, so investigate using 2 ops to enter subs (one for
XS, one for perl) and swap between if a sub is redefined.</p>
<a class='view-head2' id="Self-ties"></a><h3 class='h3' >Self-ties</h3>
<p>Self-ties are currently illegal because they caused too many segfaults. Maybe
the causes of these could be tracked down and self-ties on all types
reinstated.</p>
<a class='view-head2' id="Optimize-away-%40_"></a><h3 class='h3' >Optimize away @_</h3>
<p>The old perltodo notes "Look at the "reification" code in <code class="inline"><span class="w">av</span>.<span class="w">c</span></code>
".</p>
<a class='view-head2' id="The-yada-yada-yada-operators"></a><h3 class='h3' >The yada yada yada operators</h3>
<p>Perl 6's Synopsis 3 says:</p>
<p><i>The ... operator is the "yada, yada, yada" list operator, which is used as
the body in function prototypes. It complains bitterly (by calling fail)
if it is ever executed. Variant ??? calls warn, and !!! calls die.</i></p>
<p>Those would be nice to add to Perl 5. That could be done without new ops.</p>
<a class='view-head2' id="Virtualize-operating-system-access"></a><h3 class='h3' >Virtualize operating system access</h3>
<p>Implement a set of "vtables" that virtualizes operating system access
(open(), mkdir(), unlink(), readdir(), getenv(), etc.)  At the very
least these interfaces should take SVs as "name" arguments instead of
bare char pointers; probably the most flexible and extensible way
would be for the Perl-facing interfaces to accept HVs.  The system
needs to be per-operating-system and per-file-system
hookable/filterable, preferably both from XS and Perl level
(<a href="perlport.html#Files-and-Filesystems">Files and Filesystems in perlport</a> is good reading at this point,
in fact, all of <a href="perlport.html">perlport</a> is.)</p>
<p>This has actually already been implemented (but only for Win32),
take a look at <i>iperlsys.h</i> and <i>win32/perlhost.h</i>.  While all Win32
variants go through a set of "vtables" for operating system access,
non-Win32 systems currently go straight for the POSIX/UNIX-style
system/library call.  Similar system as for Win32 should be
implemented for all platforms.  The existing Win32 implementation
probably does not need to survive alongside this proposed new
implementation, the approaches could be merged.</p>
<p>What would this give us?  One often-asked-for feature this would
enable is using Unicode for filenames, and other "names" like %ENV,
usernames, hostnames, and so forth.
(See <a href="perlunicode.html#When-Unicode-Does-Not-Happen">When Unicode Does Not Happen in perlunicode</a>.)</p>
<p>But this kind of virtualization would also allow for things like
virtual filesystems, virtual networks, and "sandboxes" (though as long
as dynamic loading of random object code is allowed, not very safe
sandboxes since external code of course know not of Perl's vtables).
An example of a smaller "sandbox" is that this feature can be used to
implement per-thread working directories: Win32 already does this.</p>
<p>See also <a href="#Extend-PerlIO-and-PerlIO%3a%3aScalar">Extend PerlIO and PerlIO::Scalar</a>.</p>
<a class='view-head2' id="Investigate-PADTMP-hash-pessimisation"></a><h3 class='h3' >Investigate PADTMP hash pessimisation</h3>
<p>The peephole optimier converts constants used for hash key lookups to shared
hash key scalars. Under ithreads, something is undoing this work.
See <a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2007-09/msg00793.html">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2007-09/msg00793.html</a></p>
<a class='view-head2' id="Store-the-current-pad-in-the-OP-slab-allocator"></a><h3 class='h3' >Store the current pad in the OP slab allocator</h3>
<p>Currently we leak ops in various cases of parse failure. I suggested that we
could solve this by always using the op slab allocator, and walking it to
free ops. Dave comments that as some ops are already freed during optree
creation one would have to mark which ops are freed, and not double free them
when walking the slab. He notes that one problem with this is that for some ops
you have to know which pad was current at the time of allocation, which does
change. I suggested storing a pointer to the current pad in the memory allocated
for the slab, and swapping to a new slab each time the pad changes. Dave thinks
that this would work.</p>
<a class='view-head2' id="repack-the-optree"></a><h3 class='h3' >repack the optree</h3>
<p>Repacking the optree after execution order is determined could allow
removal of NULL ops, and optimal ordering of OPs with respect to cache-line
filling.  The slab allocator could be reused for this purpose.  I think that
the best way to do this is to make it an optional step just before the
completed optree is attached to anything else, and to use the slab allocator
unchanged, so that freeing ops is identical whether or not this step runs.
Note that the slab allocator allocates ops downwards in memory, so one would
have to actually "allocate" the ops in reverse-execution order to get them
contiguous in memory in execution order.</p>
<p>See <a href="http://www.nntp.perl.org/group/perl.perl5.porters/2007/12/msg131975.html">http://www.nntp.perl.org/group/perl.perl5.porters/2007/12/msg131975.html</a></p>
<p>Note that running this copy, and then freeing all the old location ops would
cause their slabs to be freed, which would eliminate possible memory wastage if
the previous suggestion is implemented, and we swap slabs more frequently.</p>
<a class='view-head2' id="eliminate-incorrect-line-numbers-in-warnings"></a><h3 class='h3' >eliminate incorrect line numbers in warnings</h3>
<p>This code</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/use.html">use</a> <span class="w">warnings</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$undef</span><span class="sc">;</span></li><li>    </li><li>    if <span class="s">(</span><span class="i">$undef</span> == <span class="n">3</span><span class="s">)</span> <span class="s">{</span></li><li>    <span class="s">}</span> elsif <span class="s">(</span><span class="i">$undef</span> == <span class="n">0</span><span class="s">)</span> <span class="s">{</span></li><li>    <span class="s">}</span></li></ol></pre><p>used to produce this output:</p>
<pre class="verbatim"><ol><li>    <span class="w">Use</span> <span class="w">of</span> <span class="w">uninitialized</span> <span class="w">value</span> <span class="w">in</span> <span class="w">numeric</span> eq <span class="s">(</span>==<span class="s">)</span> <span class="w">at</span> <span class="w">wrong</span>.<span class="w">pl</span> <span class="w">line</span> <span class="n">4.</span></li><li>    <span class="w">Use</span> <span class="w">of</span> <span class="w">uninitialized</span> <span class="w">value</span> <span class="w">in</span> <span class="w">numeric</span> eq <span class="s">(</span>==<span class="s">)</span> <span class="w">at</span> <span class="w">wrong</span>.<span class="w">pl</span> <span class="w">line</span> <span class="n">4.</span></li></ol></pre><p>where the line of the second warning was misreported - it should be line 5.
Rafael fixed this - the problem arose because there was no nextstate OP
between the execution of the <code class="inline">if</code>
 and the <code class="inline">elsif</code>
, hence <code class="inline"><span class="w">PL_curcop</span></code>
 still
reports that the currently executing line is line 4. The solution was to inject
a nextstate OPs for each <code class="inline">elsif</code>
, although it turned out that the nextstate
OP needed to be a nulled OP, rather than a live nextstate OP, else other line
numbers became misreported. (Jenga!)</p>
<p>The problem is more general than <code class="inline">elsif</code>
 (although the <code class="inline">elsif</code>
 case is the
most common and the most confusing). Ideally this code</p>
<pre class="verbatim"><ol><li>    <a class="l_k" href="functions/use.html">use</a> <span class="w">warnings</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$undef</span><span class="sc">;</span></li><li>    </li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$a</span> = <span class="i">$undef</span> + <span class="n">1</span><span class="sc">;</span></li><li>    <a class="l_k" href="functions/my.html">my</a> <span class="i">$b</span></li><li>      = <span class="i">$undef</span></li><li>      + <span class="n">1</span><span class="sc">;</span></li></ol></pre><p>would produce this output</p>
<pre class="verbatim"><ol><li>    <span class="w">Use</span> <span class="w">of</span> <span class="w">uninitialized</span> <span class="w">value</span> <span class="i">$undef</span> <span class="w">in</span> <span class="w">addition</span> <span class="s">(</span>+<span class="s">)</span> <span class="w">at</span> <span class="w">wrong</span>.<span class="w">pl</span> <span class="w">line</span> <span class="n">4.</span></li><li>    <span class="w">Use</span> <span class="w">of</span> <span class="w">uninitialized</span> <span class="w">value</span> <span class="i">$undef</span> <span class="w">in</span> <span class="w">addition</span> <span class="s">(</span>+<span class="s">)</span> <span class="w">at</span> <span class="w">wrong</span>.<span class="w">pl</span> <span class="w">line</span> <span class="n">7.</span></li></ol></pre><p>(rather than lines 4 and 5), but this would seem to require every OP to carry
(at least) line number information.</p>
<p>What might work is to have an optional line number in memory just before the
BASEOP structure, with a flag bit in the op to say whether it's present.
Initially during compile every OP would carry its line number. Then add a late
pass to the optimiser (potentially combined with <a href="#repack-the-optree">repack the optree</a>) which
looks at the two ops on every edge of the graph of the execution path. If
the line number changes, flags the destination OP with this information.
Once all paths are traced, replace every op with the flag with a
nextstate-light op (that just updates <code class="inline"><span class="w">PL_curcop</span></code>
), which in turn then passes
control on to the true op. All ops would then be replaced by variants that
do not store the line number. (Which, logically, why it would work best in
conjunction with <a href="#repack-the-optree">repack the optree</a>, as that is already copying/reallocating
all the OPs)</p>
<p>(Although I should note that we're not certain that doing this for the general
case is worth it)</p>
<a class='view-head2' id="optimize-tail-calls"></a><h3 class='h3' >optimize tail-calls</h3>
<p>Tail-calls present an opportunity for broadly applicable optimization;
anywhere that <code class="inline"><a class="l_k" href="functions/return.html">return</a> <span class="i">foo</span><span class="s">(</span>...<span class="s">)</span></code>
 is called, the outer return can
be replaced by a goto, and foo will return directly to the outer
caller, saving (conservatively) 25% of perl's call&amp;return cost, which
is relatively higher than in C.  The scheme language is known to do
this heavily.  B::Concise provides good insight into where this
optimization is possible, ie anywhere entersub,leavesub op-sequence
occurs.</p>
<pre class="verbatim"><ol><li> <span class="w">perl</span> -<span class="w">MO</span>=<span class="w">Concise</span><span class="cm">,</span>-<a class="l_k" href="functions/exec.html">exec</a><span class="cm">,</span><span class="w">a</span><span class="cm">,</span><span class="w">b</span><span class="cm">,</span>-<span class="w">main</span> -e <span class="q">&#39;sub a{ 1 }; sub b {a()}; b(2)&#39;</span></li></ol></pre><p>Bottom line on this is probably a new pp_tailcall function which
combines the code in pp_entersub, pp_leavesub.  This should probably
be done 1st in XS, and using B::Generate to patch the new OP into the
optrees.</p>
<a class='view-head1' id="Big-projects"></a><h2 class='h2' >Big projects</h2>
<p>Tasks that will get your name mentioned in the description of the "Highlights
of 5.12"</p>
<a class='view-head2' id="make-ithreads-more-robust"></a><h3 class='h3' >make ithreads more robust</h3>
<p>Generally make ithreads more robust. See also <a href="#iCOW">iCOW</a></p>
<p>This task is incremental - even a little bit of work on it will help, and
will be greatly appreciated.</p>
<p>One bit would be to write the missing code in sv.c:Perl_dirp_dup.</p>
<p>Fix Perl_sv_dup, et al so that threads can return objects.</p>
<a class='view-head2' id="iCOW"></a><h3 class='h3' >iCOW</h3>
<p>Sarathy and Arthur have a proposal for an improved Copy On Write which
specifically will be able to COW new ithreads. If this can be implemented
it would be a good thing.</p>
<a class='view-head2' id="(%3f%7b...%7d)-closures-in-regexps"></a><h3 class='h3' >(?{...}) closures in regexps</h3>
<p>Fix (or rewrite) the implementation of the <code class="inline"><span class="q">/(?{...})/</span></code>
 closures.</p>
<a class='view-head2' id="A-re-entrant-regexp-engine"></a><h3 class='h3' >A re-entrant regexp engine</h3>
<p>This will allow the use of a regex from inside (?{ }), (??{ }) and
(?(?{ })|) constructs.</p>
<a class='view-head2' id="Add-class-set-operations-to-regexp-engine"></a><h3 class='h3' >Add class set operations to regexp engine</h3>
<p>Apparently these are quite useful. Anyway, Jeffery Friedl wants them.</p>
<p>demerphq has this on his todo list, but right at the bottom.  </p>




      <ul><li><a href="#NAME">NAME</a></li><li><a href="#DESCRIPTION">DESCRIPTION</a></li><li><a href="#Tasks-that-only-need-Perl-knowledge">Tasks that only need Perl knowledge</a></li><ul><li><a href="#Smartmatch-design-issues">Smartmatch design issues</a></li><li><a href="#Remove-duplication-of-test-setup.">Remove duplication of test setup.</a></li><li><a href="#POD--%3e-HTML-conversion-in-the-core-still-sucks">POD -> HTML conversion in the core still sucks</a></li><li><a href="#merge-checkpods-and-podchecker">merge checkpods and podchecker</a></li><li><a href="#Parallel-testing">Parallel testing</a></li><li><a href="#Make-Schwern-poorer">Make Schwern poorer</a></li><li><a href="#Improve-the-coverage-of-the-core-tests">Improve the coverage of the core tests</a></li><li><a href="#test-B">test B</a></li><li><a href="#Deparse-inlined-constants">Deparse inlined constants</a></li><li><a href="#A-decent-benchmark">A decent benchmark</a></li><li><a href="#fix-tainting-bugs">fix tainting bugs</a></li><li><a href="#Dual-life-everything">Dual life everything</a></li><li><a href="#Bundle-dual-life-modules-in-ext%2f">Bundle dual life modules in ext/</a></li><li><a href="#POSIX-memory-footprint">POSIX memory footprint</a></li><li><a href="#embed.pl%2fmakedef.pl">embed.pl/makedef.pl</a></li><li><a href="#use-strict%3b-and-AutoLoad">use strict; and AutoLoad</a></li><li><a href="#profile-installman">profile installman</a></li></ul><li><a href="#Tasks-that-need-a-little-sysadmin-type-knowledge">Tasks that need a little sysadmin-type knowledge</a></li><ul><li><a href="#make-HTML-install-work">make HTML install work</a></li><li><a href="#compressed-man-pages">compressed man pages</a></li><li><a href="#Add-a-code-coverage-target-to-the-Makefile">Add a code coverage target to the Makefile</a></li><li><a href="#Make-Config.pm-cope-with-differences-between-built-and-installed-perl">Make Config.pm cope with differences between built and installed perl</a></li><li><a href="#linker-specification-files">linker specification files</a></li><li><a href="#Cross-compile-support">Cross-compile support</a></li><li><a href="#roffitall">roffitall</a></li><li><a href="#Split-%22linker%22-from-%22compiler%22">Split "linker" from "compiler"</a></li></ul><li><a href="#Tasks-that-need-a-little-C-knowledge">Tasks that need a little C knowledge</a></li><ul><li><a href="#Weed-out-needless-PERL_UNUSED_ARG">Weed out needless PERL_UNUSED_ARG</a></li><li><a href="#Modernize-the-order-of-directories-in-%40INC">Modernize the order of directories in @INC</a></li><li><a href="#-Duse32bit*">-Duse32bit*</a></li><li><a href="#Make-it-clear-from--v-if-this-is-the-exact-official-release">Make it clear from -v if this is the exact official release</a></li><li><a href="#Profile-Perl---am-I-hot-or-not%3f">Profile Perl - am I hot or not?</a></li><li><a href="#Allocate-OPs-from-arenas">Allocate OPs from arenas</a></li><li><a href="#Improve-win32%2fwince.c">Improve win32/wince.c</a></li><li><a href="#Use-secure-CRT-functions-when-building-with-VC8-on-Win32">Use secure CRT functions when building with VC8 on Win32</a></li><li><a href="#Fix-POSIX%3a%3aaccess()-and-chdir()-on-Win32">Fix POSIX::access() and chdir() on Win32</a></li><li><a href="#strcat()%2c-strcpy()%2c-strncat()%2c-strncpy()%2c-sprintf()%2c-vsprintf()">strcat(), strcpy(), strncat(), strncpy(), sprintf(), vsprintf()</a></li><li><a href="#-D_FORTIFY_SOURCE%3d2%2c--fstack-protector">-D_FORTIFY_SOURCE=2, -fstack-protector</a></li><li><a href="#Arenas-for-GPs%3f-For-MAGIC%3f">Arenas for GPs? For MAGIC?</a></li><li><a href="#Shared-arenas">Shared arenas</a></li></ul><li><a href="#Tasks-that-need-a-knowledge-of-XS">Tasks that need a knowledge of XS</a></li><ul><li><a href="#investigate-removing-int_macro_int-from-POSIX.xs">investigate removing int_macro_int from POSIX.xs</a></li><li><a href="#safely-supporting-POSIX-SA_SIGINFO">safely supporting POSIX SA_SIGINFO</a></li><li><a href="#autovivification">autovivification</a></li><li><a href="#Unicode-in-Filenames">Unicode in Filenames</a></li><li><a href="#Unicode-in-%25ENV">Unicode in %ENV</a></li><li><a href="#Unicode-and-glob()">Unicode and glob()</a></li><li><a href="#Unicode-and-lc%2fuc-operators">Unicode and lc/uc operators</a></li><li><a href="#use-less-'memory'">use less 'memory'</a></li><li><a href="#Re-implement-%3aunique-in-a-way-that-is-actually-thread-safe">Re-implement :unique in a way that is actually thread-safe</a></li><li><a href="#Make-tainting-consistent">Make tainting consistent</a></li><li><a href="#readpipe(LIST)">readpipe(LIST)</a></li><li><a href="#Audit-the-code-for-destruction-ordering-assumptions">Audit the code for destruction ordering assumptions</a></li><li><a href="#Extend-PerlIO-and-PerlIO%3a%3aScalar">Extend PerlIO and PerlIO::Scalar</a></li><li><a href="#-C-on-the-%23!-line">-C on the #! line</a></li><li><a href="#Propagate-const-outwards-from-Perl_moreswitches()">Propagate const outwards from Perl_moreswitches()</a></li><li><a href="#Duplicate-logic-in-S_method_common()-and-Perl_gv_fetchmethod_autoload()">Duplicate logic in S_method_common() and Perl_gv_fetchmethod_autoload()</a></li><li><a href="#Organize-error-messages">Organize error messages</a></li></ul><li><a href="#Tasks-that-need-a-knowledge-of-the-interpreter">Tasks that need a knowledge of the interpreter</a></li><ul><li><a href="#error-reporting-of-%5b%24a-%3b-%24b%5d">error reporting of [$a ; $b]</a></li><li><a href="#UTF-8-revamp">UTF-8 revamp</a></li><li><a href="#Properly-Unicode-safe-tokeniser-and-pads.">Properly Unicode safe tokeniser and pads.</a></li><li><a href="#state-variable-initialization-in-list-context">state variable initialization in list context</a></li><li><a href="#Implement-%24value-~~-0-..-%24range">Implement $value ~~ 0 .. $range</a></li><li><a href="#A-does()-built-in">A does() built-in</a></li><li><a href="#Tied-filehandles-and-write()-don't-mix">Tied filehandles and write() don't mix</a></li><li><a href="#Attach%2fdetach-debugger-from-running-program">Attach/detach debugger from running program</a></li><li><a href="#Optimize-away-empty-destructors">Optimize away empty destructors</a></li><li><a href="#LVALUE-functions-for-lists">LVALUE functions for lists</a></li><li><a href="#LVALUE-functions-in-the-debugger">LVALUE functions in the debugger</a></li><li><a href="#regexp-optimiser-optional">regexp optimiser optional</a></li><li><a href="#delete-%26function">delete &function</a></li><li><a href="#%2fw-regex-modifier">/w regex modifier</a></li><li><a href="#optional-optimizer">optional optimizer</a></li><li><a href="#You-WANT-*how*-many">You WANT *how* many</a></li><li><a href="#lexical-aliases">lexical aliases</a></li><li><a href="#entersub-XS-vs-Perl">entersub XS vs Perl</a></li><li><a href="#Self-ties">Self-ties</a></li><li><a href="#Optimize-away-%40_">Optimize away @_</a></li><li><a href="#The-yada-yada-yada-operators">The yada yada yada operators</a></li><li><a href="#Virtualize-operating-system-access">Virtualize operating system access</a></li><li><a href="#Investigate-PADTMP-hash-pessimisation">Investigate PADTMP hash pessimisation</a></li><li><a href="#Store-the-current-pad-in-the-OP-slab-allocator">Store the current pad in the OP slab allocator</a></li><li><a href="#repack-the-optree">repack the optree</a></li><li><a href="#eliminate-incorrect-line-numbers-in-warnings">eliminate incorrect line numbers in warnings</a></li><li><a href="#optimize-tail-calls">optimize tail-calls</a></li></ul><li><a href="#Big-projects">Big projects</a></li><ul><li><a href="#make-ithreads-more-robust">make ithreads more robust</a></li><li><a href="#iCOW">iCOW</a></li><li><a href="#(%3f%7b...%7d)-closures-in-regexps">(?{...}) closures in regexps</a></li><li><a href="#A-re-entrant-regexp-engine">A re-entrant regexp engine</a></li><li><a href="#Add-class-set-operations-to-regexp-engine">Add class set operations to regexp engine</a></li></ul></ul>


                  </div>
                </article>
              </div>
            </div>
          </main>
        </div>
           <footer class="footer row bg-light pt-5 pb-5">
       <div class="col-sm-10 offset-sm-1 col-xl-8 offset-xl-2">
           <div class="row">
               <div class="col-md-4">
                   <ul class="list-unstyled">
                       <li>
                           <h4>Site info</h4>
                       </li>
                       <li>Docs mantained by
                           <a href="//lists.perl.org/list/perl5-porters.html"
                               rel="noopener">Perl 5 Porters</a>
                       </li>
                       <li>Perldoc site development sponsored by
                           <a href="//opusvl.com" rel="noopener">
                           <img style="margin: 20px 20px 5px 10px" class="opus-logo" src="/public/img/opusvl_logo.svg" alt="OpusVL Logo">
                        </a>
                    <li><span class="about_perldoc"><a href="//about.html">About PerlDOC</a></span>
                    </li>
                       </li>
                   </ul>
               </div>
               <div class="col-md-8">
                   <div class="row">
                       <div class="col-md-6 col-lg-3">
                           <ul class=" list-unstyled">
                               <li>
                                   <h4>Manuals</h4>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/index-overview.html">Overview</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/index-tutorials.html">Tutorials</a>
                               </li>
                               <li>
                                   <a href="/5.8.9/index-faq.html">FAQs</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/index-history.html">Changes</a>
                               </li>
                           </ul>
                       </div>
                       <div class="col-md-6 col-lg-3">
                           <ul class=" list-unstyled">
                               <li>
                                   <h4>Reference</h4>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/index-language.html">Language</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/index-functions.html">Functions</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/perlop.html">Operators</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/perlvar.html">Variables</a>
                               </li>
                           </ul>
                       </div>
                       <div class="col-md-6 col-lg-3">
                           <ul class=" list-unstyled">
                               <li>
                                   <h4>Modules</h4>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/index-modules-A.html">Modules</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/index-pragmas.html">Pragmas</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/index-utilities.html">Utilities</a>
                               </li>
                           </ul>
                       </div>
                       <div class="col-md-6 col-lg-3">
                           <ul class=" list-unstyled">
                               <li>
                                   <h4>Misc</h4>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/index-licence.html">License</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/index-internals.html">Internals</a>
                               </li>
                               <li>
                                   <a
                                       href="/5.8.9/index-platforms.html">Platforms</a>
                               </li>
                            <li>
                                <a
                                    href="/5.8.9/index-about.html">About</a>
                            </li>
                           </ul>
                       </div>
                   </div>
               </div>
               <div class=" col-12 footer-inf text-center">
                   <small>perldoc.perl.org - Official documentation for the Perl
                       programming language</small>
               </div>
           </div>
       </div>
   </footer>

        	<div class="beta-wrapper beta-bottom-right ">
		<div class="beta beta-blue  ">
			<a class="beta-link "
				href="//github.com/OpusVL/perldoc.perl.org/issues/new" rel="noopener">
				<span class="beta-text">
					This website is a Beta release.
				</span>
				<span class="beta-text">
					For any issues please raise a ticket on GitHub
				</span>
			</a>
		</div>
	</div>

        <script src="/public/js/main.min.js"></script>
      </body>

      </html>
